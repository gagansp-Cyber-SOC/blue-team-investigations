ğŸŒğŸ” UNUSUAL LOGIN / IMPOSSIBLE TRAVEL â€” COMPLETE SOC INVESTIGATION PLAYBOOK


---

ğŸ“˜ğŸ§  DEFINITION â€” WHAT THIS ALERT REALLY MEANS

ğŸŒ Impossible Travel triggers when the same user account logs in successfully from two distant geolocations within a timeframe impossible for human travel
ğŸ§  This maps to MITRE ATT&CK T1078 â€“ Valid Accounts
ğŸš¨ This means credentials are already valid, not guessed
âš ï¸ This is more dangerous than failed logins


---

â±ï¸ğŸ“ SLA â€” WHY SPEED MATTERS

ğŸš¨ High risk â†’ investigate within 1 hour
âš ï¸ Medium risk â†’ investigate same business day
ğŸ§  Identity attacks move fast before endpoint alerts appear


---

ğŸ§­ğŸ• PHASE 1 â€” ALERT INTAKE (FIRST 5 MINUTES)

â“ğŸ§  WHY THIS PHASE IS CRITICAL

ğŸš« Impossible travel alerts are very noisy
ğŸŒ VPNs, mobile ISPs, proxies cause false positives
âš ï¸ Misunderstanding detection logic leads to:
âŒ Closing real compromises
âŒ Chasing VPN noise


---

ğŸ¯ğŸ” WHAT THIS ALERT IS TRYING TO DETECT

âœ… Two successful logins
ğŸ‘¤ Same user
ğŸŒ Different IPs / geos
â±ï¸ Short time window
ğŸ“ Travel speed > 500â€“900 km/h

ğŸš¨ Failed logins do NOT count


---

ğŸ“ğŸ” WHERE TO LOOK FIRST

ğŸ“Š SIEM alert payload
âš™ï¸ Detection rule configuration
ğŸ“ Calculated fields (distance, speed)
ğŸ§  UEBA risk score


---

ğŸ“‹ğŸ“Š WHAT FIELDS TO CONFIRM IMMEDIATELY

ğŸ‘¤ User principal â†’ identity at risk
ğŸ• Old login time / IP / geo â†’ baseline
ğŸ•’ New login time / IP / geo â†’ anomaly
ğŸ“ Distance & speed â†’ impossibility proof
âœ… Login result â†’ must be SUCCESS
ğŸ“Š Risk score â†’ prioritization
ğŸ” Source â†’ IdP vs endpoint


---

ğŸ§ªğŸ” HOW TO ANALYZE IN SIEM

ğŸ–±ï¸ Open raw contributing events, not summary
âœ… Confirm both logins succeeded
ğŸ“ Validate distance Ã· time calculation
ğŸ‘¤ Confirm user is not a service account


---

ğŸ§¾ğŸ“„ SAMPLE SIEM ALERT (REALISTIC)

{
  "alert": "Impossible Travel Detected",
  "user": "alice@corp.com",
  "old_login": {
    "time": "2026-01-03 14:00 IST",
    "ip": "103.1.2.3",
    "geo": "Haryana, IN"
  },
  "new_login": {
    "time": "2026-01-03 14:05 IST",
    "ip": "198.51.100.50",
    "geo": "New York, US"
  },
  "distance_km": 12800,
  "speed_kmh": 2560,
  "source": "Okta"
}

ğŸš© Speed + success = real risk


---

â–¶ï¸ğŸ§  WHEN TO MOVE FORWARD

âœ… Detection logic validated
âœ… Both logins successful
âœ… Human user confirmed


---

â˜ï¸ğŸ” PHASE 2 â€” IDENTITY PROVIDER LOGS (SOURCE OF TRUTH)

â“ğŸ§  WHY IDP LOGS MATTER MOST

ğŸ” Impossible travel is identity-layer, not endpoint
â˜ï¸ IdPs calculate geo, device, MFA, risk
ğŸš¨ Most BEC and cloud breaches start here


---

ğŸ“ğŸ“‚ WHERE TO LOOK (PLATFORMS & PATHS)

ğŸ”¹ Azure AD / Entra ID
ğŸ“ Portal â†’ Entra ID â†’ Monitoring â†’ Sign-in logs

ğŸ”¹ Okta
ğŸ“ Admin Console â†’ System Log

ğŸ”¹ Google Workspace
ğŸ“ Admin â†’ Reports â†’ Login Audit

ğŸ”¹ Microsoft 365
ğŸ“ Unified Audit Log


---

ğŸ“‹ğŸ” WHAT FIELDS TO EXTRACT

ğŸ‘¤ userPrincipalName â†’ target identity
ğŸŒ client.ipAddress â†’ source
ğŸŒ location â†’ geo validation
ğŸ§  userAgent â†’ automation vs human
ğŸ” authenticationStep â†’ MFA context
âœ… outcome â†’ success or failure
ğŸ“Š riskLevel â†’ UEBA confidence


---

ğŸ§ªğŸ“„ SAMPLE OKTA LOG (REALISTIC)

{
  "eventType": "user.session.start",
  "actor": { "alternateId": "alice@corp.com" },
  "client": {
    "ipAddress": "198.51.100.50",
    "geographicalContext": {
      "city": "New York",
      "country": "US"
    }
  },
  "debugContext": {
    "debugData": {
      "isImpossibleTraveler": true,
      "distanceKm": 12800
    }
  },
  "outcome": { "result": "SUCCESS" }
}

ğŸš© SUCCESS + impossible travel = high confidence compromise


---

ğŸ”ğŸ–¥ï¸ PHASE 3 â€” VPN & ENDPOINT VALIDATION

â“ğŸ§  WHY THIS PHASE EXISTS

ğŸ” Identity compromise matters only if access was used
ğŸ‘‰ This phase answers: Did attacker go anywhere?


---

ğŸ“ğŸ“‚ WHERE TO LOOK

ğŸ”¹ VPN Logs
ğŸ“ FortiGate â†’ Log & Report â†’ VPN
ğŸ“ Palo Alto â†’ Monitor â†’ GlobalProtect
ğŸ“ Cisco â†’ /var/log/auth.log

ğŸ”¹ Windows Logs
ğŸ“ Event Viewer â†’ Windows Logs â†’ Security

ğŸ“„ Physical file

C:\Windows\System32\winevt\Logs\Security.evtx


---

ğŸ“‹ğŸ” WHAT TO CHECK

ğŸ” LogonType â†’ RDP vs VPN vs SMB
ğŸŒ IpAddress â†’ match IdP IP
ğŸ’» WorkstationName â†’ endpoint touched
â±ï¸ Session duration â†’ attacker dwell time
ğŸ“Š Bytes in/out â†’ data access


---

ğŸ§ªğŸ“„ SAMPLE WINDOWS 4624

Event ID: 4624
Account Name: alice
Logon Type: 3
Source Network Address: 198.51.100.50
Workstation Name: WORKSTATION-XYZ

ğŸš© Cloud login + network logon = confirmed access


---

ğŸ“ŠğŸ§  PHASE 4 â€” HISTORICAL BASELINE

â“ğŸ§  WHY BASELINE MATTERS

ğŸŒ Impossible travel only makes sense relative to normal behavior


---

ğŸ“ğŸ“‚ WHERE TO LOOK

ğŸ“Š SIEM historical queries
ğŸ§  UEBA user profile
ğŸ“œ Past IdP sign-ins


---

ğŸ“‹ğŸ” WHAT TO BUILD

ğŸ“… Last 7 / 30 / 90 days logins
ğŸŒ Common countries
ğŸŒ Known VPN IP ranges


---

ğŸ’»ğŸ§ª SAMPLE SIEM QUERY

user=alice
| where auth_result="SUCCESS"
| stats count by country, ip_asn


---

ğŸ”ğŸŒ PHASE 5 â€” ENRICHMENT & FALSE POSITIVE CONTROL

â“ğŸ§  WHY THIS PHASE EXISTS

ğŸš« Most impossible travel alerts are VPN-related
ğŸ§  Enrichment prevents false closures


---

ğŸ“ğŸ“‚ WHERE TO ENRICH

ğŸŒ VirusTotal
ğŸŒ AbuseIPDB
ğŸŒ ASN lookup
ğŸ“± Device history


---

ğŸ“‹ğŸ” WHAT TO VALIDATE

ğŸ¢ ASN type â†’ corporate vs residential
ğŸ•µï¸ TOR / proxy usage
ğŸ“± Device ID â†’ known or new
ğŸ‘¥ Other users on same IP


---

ğŸ§ªğŸ“„ SAMPLE ENRICHMENT

IP: 198.51.100.50
ASN: Verizon (Residential)
TOR: No
User Agent: Chrome/120

ğŸš© Residential IP + new geo = high risk


---

ğŸ”ğŸ§  PHASE 6 â€” POST-LOGIN IMPACT & HUNT

â“ğŸ§  WHY THIS IS MANDATORY

ğŸš¨ If login succeeded, assume breach until disproven


---

ğŸ“ğŸ“‚ WHERE TO HUNT

ğŸ”¹ Endpoint
âš™ï¸ powershell.exe
âš™ï¸ cmd.exe
âš™ï¸ rundll32.exe

ğŸ”¹ Windows Logs
ğŸ“„ Event ID 4688 â†’ process creation
ğŸ“„ Event ID 4672 â†’ privilege use

ğŸ”¹ Cloud
ğŸ“§ Mailbox rules
ğŸ” OAuth app consent
ğŸ“¥ Mass downloads


---

ğŸ§ªğŸ“„ SAMPLE POST-LOGIN ACTIVITY

14:10 powershell.exe -EncodedCommand
14:15 net use \\DC01 /user:admin

ğŸš¨ This upgrades alert to INCIDENT


---

âš–ï¸ğŸš¨ PHASE 7 â€” CLASSIFICATION & RESPONSE

ğŸ“ŠğŸ§  DECISION LOGIC

Scenario	Verdict	Action

VPN confirmed	Benign	Update baseline
User confirms travel	Benign	Close
Fast travel + MFA	Medium	Monitor
Success + no confirmation	High	Reset creds
Post-login abuse	Incident	Full IR



---

ğŸ› ï¸ğŸš¨ RESPONSE ACTIONS

â›” Block session & IP
ğŸ”‘ Reset credentials
ğŸ”„ Revoke tokens
ğŸ” Enforce MFA
ğŸ” Full endpoint hunt


---

ğŸ§ ğŸ”¥ FINAL SOC TRUTH

ğŸŒ Impossible travel is not about geography
ğŸ” It is about identity trust failure
â±ï¸ Speed + success + context = truth

> ğŸš¨ If the login succeeded, assume compromise until disproven
