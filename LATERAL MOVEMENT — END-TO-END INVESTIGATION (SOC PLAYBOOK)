# ðŸ§  LATERAL MOVEMENT â€” END-TO-END INVESTIGATION (SOC PLAYBOOK)

Beginner-friendly, step-by-step guide for SOC L1/L2 analysts to investigate **lateral movement** using real logs, tools, and decision logic. Written to explain **from where to check, what to check, how to check, and how to differentiate normal vs attacker behavior**.

---

## ðŸ”´ 1ï¸âƒ£ WHEN DO YOU SUSPECT LATERAL MOVEMENT

### ðŸ” What to observe

You are not confirming an attack yet. You are identifying **unusual internal behavior patterns**.

### ðŸ“ Where to notice first

* SIEM dashboards
* EDR alerts
* Firewall internal (east-west) traffic
* Active Directory / Identity logs

### ðŸš© Common suspicious patterns

#### ðŸ” Same user across multiple hosts

* Check in SIEM by filtering on **username**
* Review number of destination hosts

ðŸŸ¢ Normal

* IT admin â†’ few known servers
* Predictable access pattern

ðŸ”´ Attacker

* Service or normal user account
* Access to many hosts within minutes

---

#### ðŸŒ One endpoint connecting to many internal IPs

* Check firewall or EDR network telemetry

ðŸŸ¢ Normal

* Backup, monitoring, patch servers

ðŸ”´ Attacker

* User laptop scanning multiple servers

---

#### ðŸ› ï¸ Admin tools used unexpectedly

* Check EDR process execution

ðŸŸ¢ Normal

* Known admin workstation
* Maintenance window

ðŸ”´ Attacker

* PsExec/WMI from user laptop
* Late night or odd hours

---

## ðŸ§  2ï¸âƒ£ BUILD THE INVESTIGATION QUESTION

Before opening logs, define the core question:

> â“ Did someone move from **Host A** to **Host B** using credentials or remote execution?

All evidence collected later should answer this.

---

## ðŸ§© 3ï¸âƒ£ IDENTIFY SOURCE & TARGET HOSTS

### ðŸ§  What to identify

* **Source host** â†’ where activity started
* **Target host** â†’ where access landed

### ðŸ“ Where to check

* EDR incident graph & process tree
* SIEM correlated alerts
* Firewall east-west logs

### ðŸ§ª Example

```text
EDR Alert
Host: USER-LAPTOP-23
User: svc_sql

Windows Log
4624 logon on DB-SRV-01
Source IP: USER-LAPTOP-23
```

âž¡ï¸ Source: USER-LAPTOP-23 | Target: DB-SRV-01

---

## ðŸ–¥ï¸ 4ï¸âƒ£ ENDPOINT INVESTIGATION (EDR)

### ðŸ” What to review

* Process tree (parent â†’ child)
* Execution user context
* Command-line arguments

### ðŸš© Common lateral movement tools

```text
psexec.exe
wmic.exe
powershell.exe
cmd.exe
rundll32.exe
mstsc.exe
ssh.exe
```

### ðŸ”´ Attacker example

```text
Process: psexec.exe
Parent: cmd.exe
User: DOMAIN\\svc-backup
Command: psexec \\FILE-SRV-02 cmd.exe
```

### ðŸŸ¢ Legit admin example

```text
Process: psexec.exe
User: DOMAIN\\IT-Admin
Source: JUMP-SERVER-01
Time: Maintenance window
```

---

## ðŸªŸ 5ï¸âƒ£ WINDOWS SECURITY LOGS

### ðŸ“ Log path

```text
Event Viewer â†’ Windows Logs â†’ Security
```

---

### ðŸ”‘ Event ID 4624 â€” Successful Logon

#### ðŸ” Fields to check

* Account Name
* Logon Type
* Source IP
* Target Host
* Time

| Logon Type | Meaning                |
| ---------- | ---------------------- |
| 3          | Network (SMB / PsExec) |
| 10         | RDP                    |
| 9          | Pass-the-Hash          |

#### ðŸ”´ Attacker example

```text
Event ID: 4624
Logon Type: 3
Account: svc_sql
Source IP: 10.10.10.45
Time: 03:12 AM
```

---

### ðŸ” Event ID 4672 â€” Privileged Logon

Indicates admin-level privileges were assigned.

ðŸ”´ Red flag

```text
Account: svc_sql
Privileges: SeDebugPrivilege
```

---

### âš™ï¸ Event ID 4688 â€” Process Creation

Confirms execution on target system.

ðŸ”´ Attacker example

```text
New Process: cmd.exe
Creator: psexecsvc.exe
Account: svc_sql
```

---

## ðŸŒ 6ï¸âƒ£ NETWORK LOGS (EAST-WEST)

### ðŸ“ Where to check

* Firewall internal interfaces
* NetFlow
* EDR network telemetry

### ðŸ” Important ports

* 445 â†’ SMB
* 3389 â†’ RDP
* 5985/5986 â†’ WinRM
* 135 â†’ RPC

ðŸ”´ Attacker pattern

```text
Source: USER-LAPTOP-23
Destinations: Multiple servers
Ports: 445, 135
```

---

## ðŸ”‘ 7ï¸âƒ£ CREDENTIAL ABUSE CONFIRMATION

### ðŸ“ Where to check

* EDR memory alerts
* LSASS access
* NTLM authentication

ðŸ”´ Indicators

* LSASS read attempts
* Same account across many hosts
* NTLM instead of Kerberos

---

## ðŸ§ª 8ï¸âƒ£ TECHNIQUE CONFIRMATION

| Technique     | Evidence             |
| ------------- | -------------------- |
| PsExec        | psexecsvc.exe + 4688 |
| WMI           | wmic.exe             |
| RDP           | 4624 Type 10         |
| Pass-the-Hash | 4624 Type 9          |
| WinRM         | PowerShell + 5985    |

---

## ðŸ§° 9ï¸âƒ£ COMMON ATTACKER TOOLS

```text
PsExec
Impacket (wmiexec, smbexec)
Mimikatz
CrackMapExec
Advanced IP Scanner
netscan
```

---

## ðŸ› ï¸ 1ï¸âƒ£0ï¸âƒ£ DEFENSIVE LOG SOURCES

* EDR (CrowdStrike, Defender, SentinelOne)
* SIEM (Splunk, Sentinel, QRadar)
* Firewall logs
* AD audit logs
* Sysmon (if enabled)

---

## ðŸ§¯ 1ï¸âƒ£1ï¸âƒ£ CONTAINMENT ACTIONS

* Isolate source host
* Disable abused account
* Reset credentials
* Block east-west traffic
* Kill active sessions

---

## ðŸ§¾ 1ï¸âƒ£2ï¸âƒ£ TIMELINE BUILDING

```text
T1: Malware on Host A
T2: Credential access
T3: 4624 logon to Host B
T4: 4672 privileged access
T5: 4688 execution
```

---

## ðŸ§  1ï¸âƒ£3ï¸âƒ£ LEGIT vs ATTACKER DECISION

| Check | Legit       | Attacker     |
| ----- | ----------- | ------------ |
| User  | IT Admin    | Service/User |
| Time  | Planned     | Odd hours    |
| Host  | Jump server | User laptop  |
| Scope | Limited     | Broad        |
| Tools | RMM         | PsExec/WMI   |

---

## ðŸ“Œ 1ï¸âƒ£4ï¸âƒ£ FINAL SOC STATEMENT (REPORT READY)

> Investigation confirms unauthorized lateral movement from HOST-A to HOST-B using a compromised service account via SMB (PsExec), supported by 4624, 4672, and 4688 evidence.
