# ğŸ”ğŸ“¤ SENSITIVE DATA EXFILTRATION â€” COMPLETE SOC INVESTIGATION PLAYBOOK

---

## ğŸ§ ğŸ“˜ DEFINITION â€” WHAT SENSITIVE DATA EXFILTRATION ACTUALLY IS

Sensitive data exfiltration occurs when **confidential, regulated, or business-critical data** is **copied, transferred, uploaded, or leaked** outside authorized boundaries.

This includes:

* ğŸ“‚ PII, PCI, PHI, financial data
* ğŸ“„ Internal documents, source code, IP
* ğŸ“§ Email attachments
* â˜ï¸ Cloud storage uploads
* ğŸŒ External servers or personal devices

ğŸš¨ Exfiltration does **NOT** require malware
ğŸš¨ Legitimate tools and users are commonly abused
ğŸš¨ Most real cases use **HTTPS + trusted platforms**

---

## â±ï¸ğŸ“ SLA â€” WHY RESPONSE SPEED MATTERS

ğŸš¨ High confidence exfiltration â†’ **Investigate immediately (â‰¤ 1 hour)**
âš ï¸ Suspicious activity â†’ **Same business day**

ğŸ§  Once data leaves the environment, **you cannot pull it back**
ğŸ§  Early detection limits legal, financial, and reputational damage

---

## ğŸ§­ğŸ• PHASE 1 â€” ALERT INTAKE & CONTEXT VALIDATION

### â“ğŸ§  WHY THIS PHASE IS CRITICAL

Most false positives happen here due to:

* Legitimate uploads
* Backup jobs
* Sync clients
* Developer workflows

If you misclassify here:
âŒ You escalate normal business
âŒ Or miss real insider threats

---

### ğŸ¯ğŸ” WHAT THIS ALERT IS TRYING TO DETECT

One or more of the following:

* ğŸ“ˆ Unusual outbound data volume
* ğŸ“‚ Mass file access followed by upload
* â˜ï¸ Upload to personal or unapproved destination
* ğŸŒ™ Off-hours transfer
* ğŸ‘¤ User behavior deviation

---

### ğŸ“ğŸ” WHERE TO LOOK FIRST

* ğŸ“Š SIEM alert payload
* âš™ï¸ Detection rule logic
* ğŸ“ Thresholds / baselines
* ğŸ‘¤ User + host entities

---

### ğŸ“‹ğŸ“Š WHAT FIELDS TO CONFIRM IMMEDIATELY

ğŸ‘¤ Username â†’ data owner
ğŸ’» Hostname â†’ data source
ğŸ“‚ File names / paths â†’ sensitivity
ğŸŒ Destination domain / IP â†’ exfil path
ğŸ“¦ Bytes transferred â†’ scale
â° Timestamp â†’ business vs off-hours
âš™ï¸ Process / application â†’ tool used

---

### ğŸ§ªğŸ“„ SAMPLE SIEM ALERT (ABSTRACTED)

```json
{
  "alert": "Sensitive Data Upload Detected",
  "user": "alice",
  "host": "LAPTOP-23",
  "destination": "drive.google.com",
  "bytes_out": 4.8GB,
  "files_accessed": 312,
  "time": "23:47 IST",
  "classification": "PII"
}
```

ğŸš© Volume + sensitivity + timing = **high risk**

---

## ğŸ‘¤ğŸ§  PHASE 2 â€” USER & BUSINESS CONTEXT

### â“ğŸ§  WHY USER CONTEXT MATTERS

The **same action** can be:

* âœ… Legitimate for a developer
* ğŸš¨ Critical for HR or Finance

---

### ğŸ“ğŸ“‚ WHERE TO CHECK

* ğŸ‘¥ IAM / AD / Entra ID
* ğŸ§¾ HR role & access
* ğŸ« Ticketing / change records

---

### ğŸ“‹ğŸ” WHAT TO CHECK

ğŸ‘¤ Role & department
ğŸ” Privilege level
ğŸ“… Notice period / offboarding
ğŸ“‚ Normal data access pattern

ğŸš© Resigning user + data upload = **insider risk**

---

## ğŸ“‚ğŸ” PHASE 3 â€” FILE & DATA ANALYSIS

### â“ğŸ§  WHY THIS PHASE EXISTS

Exfiltration is about **what data**, not just how much.

---

### ğŸ“ğŸ“‚ WHERE TO LOOK

* ğŸ–¥ï¸ Endpoint file access logs
* ğŸ” DLP logs
* ğŸ“Š EDR telemetry

---

### ğŸ“‹ğŸ” WHAT TO CHECK

ğŸ“„ File names & extensions
ğŸ“‚ Directory paths
ğŸ·ï¸ Classification labels
ğŸ“Š File count vs normal

---

### ğŸ§ªğŸ“„ SAMPLE FILE ACCESS LOG (WINDOWS 4663)

```
Event ID: 4663
Object Name: C:\Users\alice\Documents\HR\Salary.xlsx
Access Mask: ReadData
Process Name: chrome.exe
```

ğŸš© Sensitive folder + read burst = staging

---

## ğŸ–¥ï¸âš™ï¸ PHASE 4 â€” PROCESS & TOOL ATTRIBUTION

### â“ğŸ§  WHY THIS MATTERS

Attackers abuse **legitimate tools** to avoid detection.

---

### ğŸ“ğŸ“‚ WHERE TO LOOK

* ğŸ›¡ï¸ EDR console
* ğŸªŸ Event Viewer â†’ Security (4688)

ğŸ“„ Log file:

```
C:\Windows\System32\winevt\Logs\Security.evtx
```

---

### ğŸ“‹ğŸ” WHAT TO CHECK

âš™ï¸ Process name
ğŸ“ Execution path
ğŸ‘¨â€ğŸ‘¦ Parent process
âŒ¨ï¸ Command line

---

### ğŸ§ªğŸ“„ SAMPLE PROCESS LOG

```
Event ID: 4688
New Process: powershell.exe
Command Line: powershell.exe Invoke-WebRequest -Uri https://dropbox.com/upload
User: alice
```

ğŸš© LOLBin + network = **covert exfil**

---

## ğŸŒğŸ“¤ PHASE 5 â€” NETWORK & DESTINATION ANALYSIS

### â“ğŸ§  WHY NETWORK IS KEY

All exfiltration leaves the network.

---

### ğŸ“ğŸ“‚ WHERE TO LOOK

* ğŸ”¥ Firewall logs
* ğŸŒ Proxy / SWG
* â˜ï¸ CASB

---

### ğŸ“‹ğŸ” WHAT TO CHECK

ğŸŒ Destination domain / IP
ğŸ“¦ Bytes out
ğŸ” TLS / HTTPS usage
ğŸ•’ Session duration

---

### ğŸ§ªğŸ“„ SAMPLE PROXY LOG

```
src_ip=10.0.1.44
user=alice
dst_domain=drive.google.com
method=POST
bytes_out=4.8GB
time=23:48
```

ğŸš© POST + cloud + off-hours = **classic exfil**

---

## â˜ï¸ğŸ” PHASE 6 â€” CLOUD / EMAIL / DLP VALIDATION

### â“ğŸ§  WHY THIS PHASE EXISTS

Most sensitive data leaves via:

* â˜ï¸ Cloud storage
* ğŸ“§ Email
* ğŸ”— File sharing links

---

### ğŸ“ğŸ“‚ WHERE TO LOOK

* â˜ï¸ CASB logs
* ğŸ“§ Email gateway
* ğŸ” DLP console

---

### ğŸ“‹ğŸ” WHAT TO CHECK

ğŸ¢ Corporate vs personal account
ğŸ“„ File sensitivity
ğŸ‘¥ External recipients
ğŸ” Share permissions

---

### ğŸ§ªğŸ“„ SAMPLE CASB LOG

```
App: Google Drive
Action: Upload
Account Type: Personal
File: Salary.xlsx
User: alice
```

ğŸš¨ Personal cloud + sensitive file = **high confidence incident**

---

## ğŸ”ğŸ§  PHASE 7 â€” TIMELINE & CORRELATION

### â“ğŸ§  WHY TIMELINE IS TRUTH

Single logs lie. Timelines donâ€™t.

---

### ğŸ“ğŸ“‚ HOW TO BUILD

* ğŸ‘¤ Pivot on user
* ğŸ’» Pivot on host
* ğŸŒ Pivot on destination
* â±ï¸ Minimum 24â€“72 hours

---

### ğŸ“‹ğŸ” WHAT TO CORRELATE

ğŸ“‚ File access â†’ upload
ğŸ” Login â†’ data movement
âš™ï¸ Script execution â†’ network

---

## âš–ï¸ğŸš¨ PHASE 8 â€” CLASSIFICATION & RESPONSE

### ğŸ“ŠğŸ§  DECISION LOGIC

| Scenario                   | Verdict  | Action   |
| -------------------------- | -------- | -------- |
| Approved upload            | Benign   | Close    |
| Role-justified             | Monitor  | Document |
| Personal cloud + sensitive | Incident | Escalate |
| Insider indicators         | Incident | IR       |

---

### ğŸ› ï¸ğŸš¨ RESPONSE ACTIONS

â›” Block destination
ğŸ” Revoke sessions
ğŸ”‘ Reset credentials
ğŸ“¦ Preserve evidence
ğŸ“£ Legal / HR notify

---

## ğŸ§ ğŸ”¥ FINAL SOC TRUTH

ğŸ“¤ Data exfiltration rarely looks malicious
â˜ï¸ Legitimate tools are the biggest risk
ğŸ‘¤ Context defines severity
â±ï¸ Once data is gone, damage is permanent

> **Exfiltration is not detected by volume alone â€”
> it is detected by behavior, context, and intent.**

