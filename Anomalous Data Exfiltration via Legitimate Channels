ğŸš¨â˜ï¸ Anomalous Data Exfiltration via Legitimate Channel

> âš ï¸ The most dangerous data exfiltration does not look malicious
âœ… It looks normal, allowed, and business-like
â˜ï¸ It hides inside trusted services and valid user activity


---

ğŸ§ ğŸ“Œ WHAT THIS SCENARIO IS ABOUT

ğŸ” This scenario detects unusual outbound data uploads
ğŸ§‘â€ğŸ’» Originating from a legitimate user workstation
â˜ï¸ Going to a legitimate external cloud service

âœ… Legitimate user
âœ… Legitimate service
âœ… Allowed protocol (HTTPS)

ğŸš© Only behavior + context + deviation expose the threat


---

ğŸ‘¤ğŸªª USER CONTEXT (START HERE â€” ALWAYS)

Before touching logs, understand the user first ğŸ‘‡

ğŸ” WHAT TO CHECK

ğŸ‘¤ Username
ğŸ¢ Department
ğŸ§‘â€ğŸ’¼ Role & responsibilities
ğŸ” Access level
ğŸ”„ Recent role change
ğŸšª Resignation / notice period

ğŸ“ WHERE TO CHECK

ğŸ§¾ IAM / Active Directory / Entra ID
ğŸ§‘â€ğŸ¤â€ğŸ§‘ HR offboarding records
ğŸ« Ticketing / Change management systems

ğŸ§  WHY TO CHECK

âš–ï¸ User role defines what is normal
ğŸ‘¨â€ğŸ’» Developer uploading 5GB â‰  ğŸ‘©â€ğŸ’¼ HR uploading 5GB
ğŸš¨ User context can instantly raise severity


---

â°ğŸš¨ WHEN TO LOOK (TRIGGER CONDITIONS)

Start investigation if any one occurs ğŸ‘‡

ğŸ“ˆ Sudden outbound upload spike
ğŸŒ™ Activity outside business hours
ğŸ†• First-time use of a cloud service
ğŸ“‚ Large file access âœ immediate upload
ğŸšª Resignation / offboarding signals
âŒ¨ï¸ Upload via scripts or sync tools

ğŸ§  WHY

ğŸ¯ Attackers prefer quiet hours
â˜ï¸ Trusted services avoid suspicion
ğŸ”‘ Valid credentials bypass controls


---

ğŸ“ğŸ” WHERE TO LOOK (DATA SOURCES)


---

ğŸŒğŸ§± NETWORK / PROXY LOGS (PRIMARY SIGNAL)

ğŸ› ï¸ TOOLS

ğŸ”¥ FortiGate
ğŸ”¥ Palo Alto
ğŸ”¥ Zscaler
ğŸ”¥ Netskope
ğŸ”¥ Secure Web Gateway

ğŸ” WHAT TO CHECK

â¡ï¸ Traffic direction â†’ Outbound
ğŸ“¤ HTTP method â†’ POST / PUT
ğŸ“¦ Bytes sent
ğŸŒ Destination domain
â° Timestamp
ğŸ‘¤ User

ğŸ“ WHERE TO CHECK

ğŸ“ Firewall logs
ğŸ“ Proxy logs
ğŸ“ CASB traffic logs

ğŸ“„ REAL SAMPLE LOG

date=2026-01-05
time=23:48:12
srcip=10.10.25.44
dst_domain=drive.google.com
method=POST
bytes_sent=4.6GB
user=gagan.s
action=allowed

ğŸš© High bytes sent
ğŸš© Cloud storage destination
ğŸš© Late-night activity

ğŸ§  WHY TO CHECK

â˜ï¸ HTTPS uploads are the top modern exfil path


---

ğŸ–¥ï¸ğŸ§  ENDPOINT / EDR TELEMETRY

ğŸ› ï¸ TOOLS

ğŸ›¡ï¸ CrowdStrike
ğŸ›¡ï¸ Microsoft Defender for Endpoint
ğŸ›¡ï¸ Carbon Black

ğŸ“ WHERE TO CHECK

Event Viewer
â†’ Windows Logs
â†’ Security

ğŸ†” WHAT TO CHECK (EVENT IDS)

ğŸ§© 4688 â†’ Process creation
ğŸ“‚ 4663 â†’ File access
ğŸ” 4624 â†’ User logon
âš ï¸ 4672 â†’ Privileged session

ğŸ“„ REAL PROCESS LOG

EventID: 4688
NewProcessName: C:\Program Files\Google\DriveFS\GoogleDriveFS.exe
ParentProcess: explorer.exe
User: gagan.s

ğŸ“„ REAL FILE ACCESS LOG

EventID: 4663
ObjectName: C:\Users\gagan.s\Documents\Finance\Salary.xlsx
AccessMask: ReadData
ProcessName: GoogleDriveFS.exe

ğŸ§  WHY TO CHECK

ğŸ“Œ Confirms what file
ğŸ“Œ Confirms which process
ğŸ“Œ Confirms how upload happened


---

ğŸ”ğŸªª AUTHENTICATION / IDENTITY LOGS

ğŸ› ï¸ TOOLS

ğŸ”‘ Active Directory
ğŸ”‘ Entra ID
ğŸ”‘ Okta
ğŸ”‘ Google Workspace

ğŸ” WHAT TO CHECK

â° Logon time
ğŸ§‘â€ğŸ’» Logon type
ğŸ’» Workstation name

ğŸ“ WHERE TO CHECK

Event Viewer â†’ Security â†’ Event ID 4624

ğŸ“„ REAL LOG

User: gagan.s
LogonType: 2
LogonTime: 23:32
Workstation: WS-044

ğŸ§  WHY TO CHECK

ğŸŒ™ Late-night interactive logons
ğŸš¨ Increase insider-risk probability


---

â˜ï¸ğŸ” CLOUD / CASB / DLP LOGS

ğŸ› ï¸ TOOLS

â˜ï¸ Netskope
â˜ï¸ Microsoft Purview
â˜ï¸ CASB
â˜ï¸ DLP

ğŸ” WHAT TO CHECK

âœ… Approved vs âŒ unapproved app
ğŸ¢ Corporate vs ğŸ‘¤ personal account
ğŸ†• First-time usage
ğŸ“„ File sensitivity

ğŸ“„ REAL CASB LOG

App: Google Drive
Activity: Upload
AccountType: Personal
File: Salary.xlsx
User: gagan.s

ğŸš© Personal account = HIGH RISK

ğŸ§  WHY TO CHECK

ğŸ¯ Personal cloud is a preferred exfil route


---

âŒ¨ï¸ğŸ› ï¸ HOW TO CHECK (ENDPOINT COMMANDS)

ğŸ”— ACTIVE CONNECTIONS

netstat -ano | findstr ESTABLISHED

ğŸ§° SUSPICIOUS TOOLS

tasklist | findstr /i "rclone winscp powershell python"

ğŸ“œ POWERSHELL HISTORY

$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

ğŸ§  WHY TO CHECK

ğŸ“¤ CLI tools are used for silent uploads


---

ğŸ“ŠğŸ“ˆ AGGREGATION & BASELINE ANALYSIS

ğŸ” AGGREGATE BY

ğŸ‘¤ User
ğŸ’» Host
â˜ï¸ Destination

ğŸ“ MEASURE

ğŸ“¦ Bytes uploaded
â³ Session duration
ğŸ” Frequency

ğŸš¨ TRIGGER WHEN

ğŸ“ˆ 3Ã—â€“5Ã— baseline deviation
ğŸ†• New destination
ğŸŒ™ Off-hours activity

ğŸ§  WHY

âŒ Static thresholds fail
âœ… Behavioral baselines work


---

ğŸ”—ğŸ§  CORRELATION IDEAS

ğŸ“¤ Large upload
â• â˜ï¸ Personal cloud
â• ğŸŒ™ Off-hours

ğŸ“‚ Mass file access
â• â±ï¸ Upload within minutes

âŒ¨ï¸ PowerShell execution
â• ğŸŒ Network upload


---

âš–ï¸ğŸš¨ DECISION LOGIC

ğŸš¨ ESCALATE

ğŸ“„ Sensitive files
ğŸ‘¤ Personal destination
ğŸŒ™ Off-hours
âŒ Role mismatch

ğŸ‘€ MONITOR

âš ï¸ One-time spike
ğŸ“‹ Business justification pending

âœ… CLOSE

âœ”ï¸ Approved sync
âœ”ï¸ Expected behavior
âœ”ï¸ Baseline matches


---

âŒğŸ•³ï¸ DETECTION GAPS (REALITY)

ğŸŒ Slow low-volume exfiltration
ğŸ” Encrypted archives
ğŸ” API-based uploads
ğŸ“¦ Long-term data staging

ğŸ§  Mitigation
ğŸ“Š Behavior analytics
ğŸ“‚ File access correlation
ğŸ‘¤ User risk scoring


---

ğŸ§ ğŸ”¥ FINAL TAKEAWAY

ğŸ”¥ Legitimate tools are modern exfil paths
ğŸ”¥ Destination reputation is weak
ğŸ”¥ Context beats volume
ğŸ”¥ User behavior defines severity

> ğŸ’¬ Not all alerts are incidents
ğŸ” But every alert deserves context-driven investigation

