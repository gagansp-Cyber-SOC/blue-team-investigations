ğŸ” MULTIPLE LOGIN FAILURES â€” FULL SOC INVESTIGATION PLAYBOOK

ğŸ§­ PHASE 1 â€” ALERT CONTEXT & DETECTION UNDERSTANDING
WHY this phase matters
If you misunderstand what the alert actually detects, everything after becomes wrong
Most false positives happen here, not later

WHAT â€œMultiple Login Failuresâ€ REALLY MEANS
It does NOT automatically mean an attack
It could be
User mistyping the password
Expired password
Service account misconfiguration
Password spray
Brute-force
Credential stuffing
Lateral movement testing
Our job is to classify which one

WHERE to look first
SIEM Alert Payload
Rule name
Threshold
Time window
Entities involved
Detection rule / correlation logic
How failures are grouped
Per user OR per IP OR per host

HOW to check in SIEM
Open the alert â†’ inspect raw contributing events, not just summary
Confirm
Number of failures (example â‰¥5)
Time window (5 min, 10 min, 1 hour)
Grouping logic
Same username?
Same source IP?
Same destination host?

WHAT FIELDS to read FIRST (non-negotiable)
Field
Why
Timestamp
Sequence & burst analysis
Username
Target selection
Source IP / Host
Attacker origin
Destination host
DC, server, VPN
Outcome
Failure vs success
Failure reason
Wrong password vs locked
Logon type / Auth method
RDP, SMB, SSH, SSO
Device vendor/product
Windows, Linux, Okta, VPN





ğŸ§  Think of it like traffic
Source IP / Host â†’ Who is coming from where
Destination host â†’ Where are they trying to go

ğŸ” Examples by scenario (very important)
ğŸ” Windows / AD login
Destination host
Domain Controller
Member Server
User workstation
SIEM field may show
DestinationHost
ComputerName
TargetHostName
dvc
host.name
ğŸ“Œ Example
Source IP: 185.23.44.10
Username: administrator
Destination Host: DC01.corp.local

ğŸ‘‰ Attacker is trying to authenticate to the Domain Controller

ğŸŒ VPN login
Destination host = VPN gateway
Examples
FortiGate01
PaloAlto-GW
Cisco ASA
Source IP: 103.21.55.9
Destination Host: FortiGate-GW
Auth: SSL VPN

ğŸ‘‰ They are attempting remote network access

ğŸ–¥ï¸ RDP attempt
Destination host = target Windows machine
Source IP: 45.77.90.12
Destination Host: FILE-SERVER-02
Logon Type: 10 (RemoteInteractive)

ğŸ‘‰ Someone is trying to RDP into that server

ğŸ§‘â€ğŸ’» Linux / SSH login
Destination host = Linux server
Source IP: 91.210.12.8
Destination Host: prod-web-01
Auth Method: SSH


â˜ï¸ Cloud / SSO (Okta, Azure AD, Google)
Destination host = application or IdP service
Examples
login.microsoftonline.com
Okta-SSO
Google Workspace
ğŸ‘‰ Here, destination host = identity service, not a physical machine
Sensitivity check
Is the target a
Domain Controller â—
Jump server â—
Database â—
VPN gateway â—
High-value destination = high risk

2ï¸âƒ£ Attack stage detection
Destination Host
Likely Stage
DC
Privilege escalation
VPN
Initial access
File server
Lateral movement
DB server
Data access / exfil


3ï¸âƒ£ Correlation logic
Example
Same source IP
Multiple usernames
Same destination host
ğŸ‘‰ Password spraying
Or
Same username
Multiple destination hosts
ğŸ‘‰ Lateral movement



WHEN to move forward
Only after you know
Exact rule logic
Which platforms are involved
Whether any success event exists nearby





Sample SIEM Normalized Event
{
  "event_type": "authentication",
  "action": "failure",
  "user": "alice",
  "src_ip": "203.0.113.5",
  "dst_host": "DC01.corp.local",
  "auth_method": "RDP",
  "failure_reason": "Bad password",
  "count_in_window": 7,
  "rule": "Multiple_Failed_Logins_5_in_10min"
}


ğŸªŸ PHASE 2 â€” WINDOWS AUTHENTICATION (EVENT ID 4625)
WHY Windows logs are critical
AD is the identity backbone
Ransomware and domain compromise usually start here
Event 4625 gives deep context

WHERE to look
On the host
Event Viewer â†’ Windows Logs â†’ Security

Physical file
C:\Windows\System32\winevt\Logs\Security.evtx

In SIEM
EventID = 4625
Provider = Microsoft-Windows-Security-Auditing


WHAT to analyze in Event ID 4625
Logon Type (HOW the attempt happened)
Logon Type
Meaning
Why it matters
2
Local console
Physical access
3
Network (SMB)
Lateral movement
10
RDP
External brute-force
4/5
Batch / Service
Misconfigured service
7
Unlock
Normal

ğŸš¨ Many failures with LogonType 10 + external IP = RDP brute force

Status / SubStatus (WHY it failed)
Code
Meaning
0xC000006A
Wrong password
0xC000006D
Invalid credentials
0xC0000064
User does not exist
0xC0000234
Account locked
0xC0000071
Password expired

Pattern insight
Many 006A â†’ guessing
Many 0064 â†’ enumeration

Network Information (WHERE from)
Source Network Address
External attacker IP ğŸŒ
Internal workstation IP ğŸ–¥ï¸
VPN-assigned IP ğŸ”
Cloud service IP â˜ï¸
Proxy / NAT IP ğŸŒ
WorkstationName
Port
Match firewall logs
Match VPN logs
Match Windows logs
Patterns
Same IP â†’ many users = password spray
Many IPs â†’ one user = credential stuffing

Sample Windows 4625 (RAW)
Event ID: 4625
Logon Type: 10
Account Name: Alice
Failure Reason: Unknown user name or bad password
Status: 0xC000006D
SubStatus: 0xC000006A
Source Network Address: 203.0.113.5


WHAT to correlate immediately
Check for Event ID 4624 (success)
Event ID: 4624
Account Name: alice
Logon Type: 10
Source IP: 203.0.113.5

ğŸš¨ Failures â†’ success = credential compromise until proven otherwise

ğŸ§ PHASE 3 â€” LINUX / SSH AUTHENTICATION
WHY this matters
SSH brute-force is constant
Attackers test default and leaked usernames
Linux logs show clear attacker intent


WHERE to look
OS
Path
Ubuntu/Debian
/var/log/auth.log
RHEL/CentOS
/var/log/secure






HOW to extract failures
grep "Failed password" /var/log/auth.log

To identify attacking IPs
grep "Failed password" /var/log/auth.log \
 | awk '{print $(NF-3)}' \
 | sort | uniq -c | sort -nr


Sample Linux SSH Failure
Failed password for invalid user admin from 203.0.113.7 port 45218 ssh2


WHAT to check
Username patterns
invalid user admin â†’ internet bot
Real employee usernames â†’ targeted attack
IP behavior
One IP many users â†’ spray
Many IPs one user â†’ stuffing
Success check
Accepted password for alice from 203.0.113.7

ğŸš¨ Success after failures = compromise

â˜ï¸ PHASE 4 â€” VPN / SSO / IDENTITY PROVIDERS
WHY IdP logs are critical
Cloud identity is primary BEC(Business Email Compromise) target
Password spray happens before endpoint compromise
Rich metadata exists (geo, device, MFA)

WHERE to look
Platform
Path
Azure AD
Entra ID â†’ Sign-in logs
Okta
System Logs
Google Workspace
Login Audit
VPN
Auth logs (RADIUS/SSL)




Perfect â€” MFA status is one of the most important fields in IdP logs, especially for BEC investigations ğŸ”
Letâ€™s break it down clearly, field by field, no fluff.

ğŸ”‘ What is MFA Status?
MFA Status tells you whether Multi-Factor Authentication was required, challenged, satisfied, bypassed, or failed during a login attempt
In simple terms
ğŸ‘‰ â€œWas the user actually protected by MFA in this login?â€

ğŸ§  Why MFA status matters
BEC attackers rarely defeat MFA technically
They avoid, bypass, or abuse it
MFA status shows how the attacker succeeded




WHAT to inspect
Field
Why
Result
Failure vs success
MFA status
Control effectiveness
Country / ASN
Geo anomaly
User agent
Automation
Risk score
UEBA signal


Sample IdP Log
{
  "user": "alice@corp.com",
  "src_ip": "198.51.100.9",
  "result": "FAILURE",
  "reason": "INVALID_CREDENTIALS",
  "mfa": "NOT_REQUIRED",
  "location": "Russia"
}

Later
{
  "user": "alice@corp.com",
  "src_ip": "198.51.100.9",
  "result": "SUCCESS",
  "mfa": "PASSED"
}

ğŸš¨ MFA pass after failures + new geo = account takeover



ğŸ” PHASE 5 â€” TIMELINE & CORRELATION (MOST IMPORTANT)
WHY this phase exists
Single log = noise
Timeline = truth

HOW to build timeline in SIEM
Pivot on
Username
Source IP
Time window
Minimum 24h
Extend to 7d for slow spray
Include
Failed logons
Successful logons
Endpoint activity
Network connections

WHAT to look for
Sudden spikes
New geo/device
Change in auth method
Post-success activity




ğŸ” PHASE 6 â€” IMPACT & LATERAL CHECKS
WHY this is required
If login succeeded, attack did not stop there

WHAT logs to check post-success
Windows
4672 â†’ privilege use
4688 â†’ process creation
5145 â†’ file shares
7045 â†’ services
Linux
sudo usage
authorized_keys changes
Cloud
Mailbox rules
App consents
Data access spikes

âš–ï¸ PHASE 7 â€” CLASSIFICATION & DECISION
Decision table
Pattern
Verdict
Few failures, user confirms
Benign
Service account repeating
Misconfiguration
Invalid users over SSH
Internet noise
Many users one IP
Password spray
Failures â†’ success
Incident



ğŸš¨ PHASE 8 â€” RESPONSE & DOCUMENTATION
Response actions
Benign
Close with note
Tune threshold
Attack without success
Block IP
Enforce MFA
Rate-limit
Compromise
Reset credentials
Revoke sessions
Full IR escalation

What to document in ticket
Detection logic
Timeline summary
Evidence snippets
Classification
Actions taken
Hardening recommendations

ğŸ§  FINAL SOC TRUTH
Multiple login failures are NOT an alert
They are a story that must be reconstructed
If you can investigate this properly
You can handle real SOC incidents confidently
