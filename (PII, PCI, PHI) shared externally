
# ğŸ”ğŸ“¤ SENSITIVE DATA EXFILTRATION (PII / PCI / PHI) â€” COMPLETE SOC INVESTIGATION PLAYBOOK

---

## ğŸ§ ğŸ“˜ DEFINITION â€” WHAT SENSITIVE DATA EXFILTRATION ACTUALLY IS

Sensitive data exfiltration occurs when **confidential, regulated, or business-critical data** is **copied, transferred, uploaded, emailed, or leaked** outside authorized organizational boundaries.

This includes but is not limited to:

* ğŸ“‚ **PII** â€” Aadhaar, PAN, passport, phone numbers, addresses
* ğŸ’³ **PCI** â€” credit/debit card numbers, CVV, expiry dates
* ğŸ¥ **PHI** â€” medical records, prescriptions, patient identifiers
* ğŸ“„ Internal documents, financial data, source code, IP
* ğŸ“§ Email attachments
* â˜ï¸ Cloud storage uploads
* ğŸŒ External servers, personal devices, or third-party platforms

ğŸš¨ Exfiltration does **NOT require malware**
ğŸš¨ Legitimate users and tools are most commonly abused
ğŸš¨ Most real cases use **HTTPS + trusted platforms (Drive, Dropbox, Gmail, OneDrive)**

---

## â±ï¸ğŸ“ SLA â€” WHY RESPONSE SPEED MATTERS

ğŸš¨ **High-confidence sensitive data exfiltration** â†’ Investigate immediately (â‰¤ 1 hour)
âš ï¸ **Suspicious but unconfirmed activity** â†’ Same business day

ğŸ§  Once sensitive data leaves the environment, **it cannot be recalled**
ğŸ§  Early investigation limits **legal, regulatory, financial, and reputational damage**

---

## ğŸ§­ğŸ• PHASE 1 â€” ALERT INTAKE & CONTEXT VALIDATION

### â“ğŸ§  WHY THIS PHASE IS CRITICAL

Most false positives originate here due to:

* Legitimate business uploads
* Backup or sync clients
* Developer workflows
* Misclassified DLP patterns

If this phase is done poorly:
âŒ Normal business is escalated
âŒ Or real insider / compromise activity is missed

---

### ğŸ¯ğŸ” WHAT THIS ALERT IS TRYING TO DETECT

One or more of the following behavioral indicators:

* ğŸ“ˆ Unusual outbound data volume
* ğŸ“‚ Mass file access followed by upload
* â˜ï¸ Upload to personal or unapproved destination
* ğŸŒ™ Off-hours transfer
* ğŸ‘¤ User behavior deviating from baseline

---

### ğŸ“ğŸ” WHERE TO LOOK FIRST

* ğŸ“Š SIEM alert payload
* âš™ï¸ Detection rule logic and thresholds
* ğŸ“ Baseline deviation logic
* ğŸ‘¤ User and host entities involved

---

### ğŸ“‹ğŸ“Š WHAT FIELDS TO CONFIRM IMMEDIATELY

ğŸ‘¤ Username â†’ data owner
ğŸ’» Hostname â†’ data source
ğŸ“‚ File names / paths â†’ sensitivity context
ğŸŒ Destination domain / IP â†’ exfil path
ğŸ“¦ Bytes transferred â†’ scale
â° Timestamp â†’ business vs off-hours
âš™ï¸ Process / application â†’ tool used

---

### ğŸ§ªğŸ“„ SAMPLE SIEM ALERT (ABSTRACTED)

```json
{
  "alert": "Sensitive Data Upload Detected",
  "user": "alice",
  "host": "LAPTOP-23",
  "destination": "drive.google.com",
  "bytes_out": 4.8GB,
  "files_accessed": 312,
  "time": "23:47 IST",
  "classification": "PII"
}
```

ğŸš© Volume + sensitivity + timing = **high risk**

---

## ğŸ‘¤ğŸ§  PHASE 2 â€” USER & BUSINESS CONTEXT

### â“ğŸ§  WHY USER CONTEXT MATTERS

The **same action** can be:

* âœ… Legitimate for engineering or data teams
* ğŸš¨ Critical for HR, Finance, or Legal

Context determines intent.

---

### ğŸ“ğŸ“‚ WHERE TO CHECK

* ğŸ‘¥ IAM / AD / Entra ID
* ğŸ§¾ HR role and department data
* ğŸ« Ticketing systems and approvals

---

### ğŸ“‹ğŸ” WHAT TO CHECK

ğŸ‘¤ Role & department
ğŸ” Privilege level
ğŸ“… Notice period / offboarding indicators
ğŸ“‚ Normal data access patterns

ğŸš© Resigning user + large data upload = **insider threat risk**

---

## ğŸ“‚ğŸ” PHASE 3 â€” FILE & DATA ANALYSIS (WHAT DATA LEFT)

### â“ğŸ§  WHY THIS PHASE EXISTS

Exfiltration is about **what data**, not just how much data.

---

### ğŸ“ğŸ“‚ WHERE TO LOOK

* ğŸ–¥ï¸ Endpoint file access logs
* ğŸ” DLP alert evidence
* ğŸ“Š EDR telemetry

---

### ğŸ“‹ğŸ” WHAT TO CHECK

ğŸ“„ File names and extensions
ğŸ“‚ Directory paths
ğŸ·ï¸ Classification labels (PII / PCI / PHI)
ğŸ“Š File count compared to baseline

---

### ğŸ§ªğŸ“„ SAMPLE WINDOWS FILE ACCESS LOG (4663)

```
Event ID: 4663
Object Name: C:\Users\alice\Documents\HR\Salary.xlsx
Access Mask: ReadData
Process Name: chrome.exe
```

ğŸš© Sensitive folder + read burst = staging activity

---

## ğŸ–¥ï¸âš™ï¸ PHASE 4 â€” PROCESS & TOOL ATTRIBUTION

### â“ğŸ§  WHY THIS MATTERS

Most data exfiltration uses **legitimate binaries (LOLBins)** to blend in.

---

### ğŸ“ğŸ“‚ WHERE TO LOOK

* ğŸ›¡ï¸ EDR console
* ğŸªŸ Event Viewer â†’ Security â†’ Event ID 4688

ğŸ“„ Physical log file:

```
C:\Windows\System32\winevt\Logs\Security.evtx
```

---

### ğŸ“‹ğŸ” WHAT TO CHECK

âš™ï¸ Process name
ğŸ“ Execution path
ğŸ‘¨â€ğŸ‘¦ Parent process
âŒ¨ï¸ Command line

---

### ğŸ§ªğŸ“„ SAMPLE PROCESS LOG

```
Event ID: 4688
New Process: powershell.exe
Command Line: powershell.exe Invoke-WebRequest -Uri https://dropbox.com/upload
User: alice
```

ğŸš© LOLBin + outbound network = covert exfiltration

---

## ğŸŒğŸ“¤ PHASE 5 â€” NETWORK & DESTINATION ANALYSIS

### â“ğŸ§  WHY NETWORK IS KEY

All exfiltration **must leave the network**.

---

### ğŸ“ğŸ“‚ WHERE TO LOOK

* ğŸ”¥ Firewall logs
* ğŸŒ Proxy / Secure Web Gateway
* â˜ï¸ CASB

---

### ğŸ“‹ğŸ” WHAT TO CHECK

ğŸŒ Destination domain / IP
ğŸ“¦ Bytes out
ğŸ” TLS / HTTPS usage
ğŸ•’ Session duration

---

### ğŸ§ªğŸ“„ SAMPLE PROXY LOG

```
src_ip=10.0.1.44
user=alice
dst_domain=drive.google.com
method=POST
bytes_out=4.8GB
time=23:48
```

ğŸš© POST + cloud storage + off-hours = classic exfil pattern

---

## â˜ï¸ğŸ“§ğŸ” PHASE 6 â€” CLOUD / EMAIL / DLP VALIDATION

### â“ğŸ§  WHY THIS PHASE EXISTS

Most sensitive data leaves via:

* â˜ï¸ Cloud storage platforms
* ğŸ“§ Email attachments
* ğŸ”— External sharing links

---

### ğŸ“ğŸ“‚ WHERE TO LOOK

* â˜ï¸ CASB logs
* ğŸ“§ Email security gateway
* ğŸ” DLP console

---

### ğŸ“‹ğŸ” WHAT TO CHECK

ğŸ¢ Corporate vs personal account
ğŸ“„ File sensitivity
ğŸ‘¥ External recipients
ğŸ” Sharing permissions

---

### ğŸ§ªğŸ“„ SAMPLE CASB LOG

```
App: Google Drive
Action: Upload
Account Type: Personal
File: Salary.xlsx
User: alice
```

ğŸš¨ Personal cloud + sensitive file = **high-confidence incident**

---

## ğŸ”ğŸ§  PHASE 7 â€” TIMELINE & CORRELATION

### â“ğŸ§  WHY TIMELINE IS TRUTH

Single alerts can mislead
Timelines reveal intent

---

### ğŸ“ğŸ“‚ HOW TO BUILD

* ğŸ‘¤ Pivot on user
* ğŸ’» Pivot on host
* ğŸŒ Pivot on destination
* â±ï¸ Minimum 24â€“72 hours

---

### ğŸ“‹ğŸ” WHAT TO CORRELATE

ğŸ“‚ File access â†’ upload
ğŸ” Authentication â†’ data movement
âš™ï¸ Script execution â†’ outbound traffic

---

## âš–ï¸ğŸš¨ PHASE 8 â€” CLASSIFICATION & RESPONSE

### ğŸ“ŠğŸ§  DECISION LOGIC

| Scenario                              | Verdict        | Action   |
| ------------------------------------- | -------------- | -------- |
| Masked / test data                    | False Positive | Close    |
| Approved business sharing             | Benign         | Document |
| Sensitive data + personal destination | Incident       | Escalate |
| Insider indicators present            | Incident       | Full IR  |

---

### ğŸ› ï¸ğŸš¨ RESPONSE ACTIONS

â›” Block destination
ğŸ” Revoke sessions
ğŸ”‘ Reset credentials
ğŸ“¦ Preserve evidence
ğŸ“£ Notify Legal / Compliance / HR

---

## ğŸ§ ğŸ”¥ FINAL SOC TRUTH

ğŸ“¤ Data exfiltration rarely looks malicious
â˜ï¸ Legitimate tools are the most abused
ğŸ‘¤ Context defines severity
â±ï¸ Once sensitive data leaves, damage is permanent

> **Exfiltration is not detected by volume alone â€”
> it is detected by behavior, context, and intent.**


