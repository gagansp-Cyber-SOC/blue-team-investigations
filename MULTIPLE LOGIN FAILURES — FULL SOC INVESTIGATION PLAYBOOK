

## ğŸ” MULTIPLE LOGIN FAILURES â€” FULL SOC INVESTIGATION PLAYBOOK

> ğŸ§  Audience: SOC L1â€“L3
> ğŸ›¡ï¸ Focus: Blue Team / Defensive
> ğŸ“Œ Principle: Context â†’ Correlation â†’ Classification

---

## ğŸ“˜ TABLE OF CONTENTS

1. Alert Context & Detection Understanding
2. Attack Stage Identification
3. Correlation Logic
4. Windows Authentication (Event ID 4625)
5. Linux / SSH Authentication
6. VPN / SSO / Identity Providers
7. Timeline & Correlation
8. Impact & Lateral Checks
9. Classification & Decision
10. Response & Documentation
11. Final SOC Truth

---

### ğŸ§  PHASE 1 â€” ALERT CONTEXT & DETECTION UNDERSTANDING

ğŸ”¸ **WHY this phase matters**
ğŸ”¸ Misunderstanding the alert = wrong investigation
ğŸ”¸ Most false positives happen here

---

#### ğŸ” WHAT â€œMultiple Login Failuresâ€ REALLY MEANS

ğŸ”¸ It does **NOT automatically mean an attack**
ğŸ”¸ Possible causes include:

* ğŸ”¹ User mistyping password
* ğŸ”¹ Expired password
* ğŸ”¹ Service account misconfiguration
* ğŸ”¹ Password spraying
* ğŸ”¹ Brute-force
* ğŸ”¹ Credential stuffing
* ğŸ”¹ Lateral movement testing

ğŸ§  SOC job = classify **which one**, not assume

---

#### ğŸ“ WHERE to look first

ğŸ”¹ SIEM Alert Payload
ğŸ”¹ Rule name
ğŸ”¹ Threshold
ğŸ”¹ Time window
ğŸ”¹ Entities involved
ğŸ”¹ Detection rule / correlation logic
ğŸ”¹ Grouping logic

* Per user
* Per IP
* Per host

---

#### ğŸ› ï¸ HOW to check in SIEM

ğŸ”¹ Open alert â†’ inspect **raw contributing events**
ğŸ”¹ Validate:

* ğŸ”¹ Failure count (example â‰¥5)
* ğŸ”¹ Time window (5 min / 10 min / 1 hour)
* ğŸ”¹ Grouping logic
* ğŸ”¹ Same username?
* ğŸ”¹ Same source IP?
* ğŸ”¹ Same destination host?

---

#### ğŸ“Š WHAT FIELDS to read FIRST (non-negotiable)

| Field                    | Why                       |
| ------------------------ | ------------------------- |
| Timestamp                | Sequence & burst analysis |
| Username                 | Target selection          |
| Source IP / Host         | Attacker origin           |
| Destination host         | DC, server, VPN           |
| Outcome                  | Failure vs success        |
| Failure reason           | Wrong password vs locked  |
| Logon type / Auth method | RDP, SMB, SSH, SSO        |
| Device vendor/product    | Windows, Linux, Okta, VPN |

---

ğŸ§  **Traffic analogy**
ğŸ”¸ Source IP â†’ who is coming
ğŸ”¸ Destination host â†’ where theyâ€™re going

---

#### ğŸ” Examples by scenario (CRITICAL)

##### ğŸ” Windows / AD login

ğŸ”¹ Destination host:

* Domain Controller
* Member Server
* User workstation

ğŸ”¹ Common SIEM fields:

* DestinationHost
* ComputerName
* TargetHostName
* dvc
* host.name

ğŸ“Œ Example

```
Source IP: 185.23.44.10
Username: administrator
Destination Host: DC01.corp.local
```

ğŸ‘‰ Authentication attempt against Domain Controller

---

##### ğŸŒ VPN login

ğŸ”¹ Destination host = VPN gateway

Examples:

* FortiGate01
* PaloAlto-GW
* Cisco ASA

```
Source IP: 103.21.55.9
Destination Host: FortiGate-GW
Auth: SSL VPN
```

ğŸ‘‰ Remote network access attempt

---

##### ğŸ–¥ï¸ RDP attempt

```
Source IP: 45.77.90.12
Destination Host: FILE-SERVER-02
Logon Type: 10
```

ğŸ‘‰ RDP attempt on server

---

##### ğŸ§‘â€ğŸ’» Linux / SSH login

```
Source IP: 91.210.12.8
Destination Host: prod-web-01
Auth Method: SSH
```

---

##### â˜ï¸ Cloud / SSO (Azure AD / Okta / Google)

ğŸ”¹ Destination = **identity service**, not a host

Examples:

* login.microsoftonline.com
* Okta-SSO
* Google Workspace

ğŸš¨ High-value targets:

* Domain Controller
* Jump server
* Database
* VPN gateway

---

### ğŸ§  2ï¸âƒ£ ATTACK STAGE IDENTIFICATION

| Destination       | Likely Stage         |
| ----------------- | -------------------- |
| Domain Controller | Privilege escalation |
| VPN               | Initial access       |
| File server       | Lateral movement     |
| DB server         | Data access / exfil  |

---

### ğŸ§  3ï¸âƒ£ CORRELATION LOGIC

ğŸ”¹ Same source IP + many users
ğŸ‘‰ Password spraying

ğŸ”¹ Same user + many hosts
ğŸ‘‰ Lateral movement

ğŸ”¹ Failures followed by success
ğŸ‘‰ Compromise until disproven

---

ğŸ›‘ **Move forward ONLY after**:

* Rule logic understood
* Platforms identified
* Success events checked

---

#### ğŸ“„ Sample SIEM Normalized Event

```json
{
  "event_type": "authentication",
  "action": "failure",
  "user": "alice",
  "src_ip": "203.0.113.5",
  "dst_host": "DC01.corp.local",
  "auth_method": "RDP",
  "failure_reason": "Bad password",
  "count_in_window": 7,
  "rule": "Multiple_Failed_Logins_5_in_10min"
}
```

---

### ğŸ§  PHASE 2 â€” WINDOWS AUTHENTICATION (EVENT ID 4625)

ğŸ”¸ **WHY Windows logs are critical**

* AD is identity backbone
* Ransomware & domain takeover start here

---

#### ğŸ“ WHERE to look

ğŸ”¹ Event Viewer
`Event Viewer â†’ Windows Logs â†’ Security`

ğŸ”¹ Physical log file
`C:\Windows\System32\winevt\Logs\Security.evtx`

ğŸ”¹ SIEM filters

* EventID = 4625
* Provider = Microsoft-Windows-Security-Auditing

---

#### ğŸ” WHAT to analyze â€” Event ID 4625

##### Logon Type (HOW)

| Type | Meaning       | Why                  |
| ---- | ------------- | -------------------- |
| 2    | Local         | Physical access      |
| 3    | Network       | Lateral movement     |
| 10   | RDP           | External brute-force |
| 4/5  | Batch/Service | Misconfig            |
| 7    | Unlock        | Normal               |

ğŸš¨ LogonType 10 + external IP = brute-force

---

##### Status / SubStatus (WHY)

| Code       | Meaning          |
| ---------- | ---------------- |
| 0xC000006A | Wrong password   |
| 0xC000006D | Invalid creds    |
| 0xC0000064 | User not found   |
| 0xC0000234 | Account locked   |
| 0xC0000071 | Password expired |

ğŸ§  Insight

* Many 006A â†’ guessing
* Many 0064 â†’ enumeration

---

##### Network Information (WHERE)

ğŸ”¹ Source Network Address
ğŸ”¹ WorkstationName
ğŸ”¹ Port

Classify source:

* ğŸŒ External
* ğŸ–¥ï¸ Internal
* ğŸ” VPN
* â˜ï¸ Cloud
* ğŸŒ Proxy/NAT

---

##### Sample RAW 4625

```
Event ID: 4625
Logon Type: 10
Account Name: Alice
Status: 0xC000006D
SubStatus: 0xC000006A
Source Network Address: 203.0.113.5
```

---

#### ğŸš¨ Correlate immediately with Event ID 4624

```
Event ID: 4624
Account Name: Alice
Logon Type: 10
Source IP: 203.0.113.5
```

ğŸš¨ Failure â†’ success = **incident**

---

### ğŸ§  PHASE 3 â€” LINUX / SSH AUTHENTICATION

ğŸ”¸ SSH brute-force is constant
ğŸ”¸ Linux logs show **clear intent**

---

#### ğŸ“ WHERE to look

| OS              | Path                |
| --------------- | ------------------- |
| Ubuntu / Debian | `/var/log/auth.log` |
| RHEL / CentOS   | `/var/log/secure`   |

---

#### ğŸ› ï¸ HOW to extract failures

```bash
grep "Failed password" /var/log/auth.log
```

Attacker IP analysis:

```bash
grep "Failed password" /var/log/auth.log \
 | awk '{print $(NF-3)}' \
 | sort | uniq -c | sort -nr
```

---

#### Sample SSH failure

```
Failed password for invalid user admin from 203.0.113.7 port 45218 ssh2
```

ğŸ§  Patterns

* invalid user â†’ bot noise
* real usernames â†’ targeted
* success after failures â†’ compromise

---

### ğŸ§  PHASE 4 â€” VPN / SSO / IDENTITY PROVIDERS

ğŸ”¸ Cloud identity = **primary BEC target**
ğŸ”¸ Rich metadata available

---

#### ğŸ“ WHERE to look

| Platform         | Path                 |
| ---------------- | -------------------- |
| Azure AD         | Entra â†’ Sign-in logs |
| Okta             | System Logs          |
| Google Workspace | Login Audit          |
| VPN              | RADIUS / SSL logs    |

---

#### ğŸ”‘ MFA Status (CRITICAL)

ğŸ”¸ Shows if protection worked or failed

Common values:

* NOT_REQUIRED
* CHALLENGED
* PASSED
* FAILED
* BYPASSED

---

#### Sample IdP log

```json
{
  "user": "alice@corp.com",
  "src_ip": "198.51.100.9",
  "result": "FAILURE",
  "mfa": "NOT_REQUIRED",
  "location": "Russia"
}
```

Later:

```json
{
  "user": "alice@corp.com",
  "src_ip": "198.51.100.9",
  "result": "SUCCESS",
  "mfa": "PASSED"
}
```

ğŸš¨ MFA success after failures + new geo = takeover

---

### ğŸ§  PHASE 5 â€” TIMELINE & CORRELATION (MOST IMPORTANT)

ğŸ”¸ Single log = noise
ğŸ”¸ Timeline = truth

ğŸ”¹ Pivot on:

* Username
* Source IP
* 24h minimum (7d for slow spray)

Include:

* Failures
* Successes
* Endpoint activity
* Network traffic

---

### ğŸ§  PHASE 6 â€” IMPACT & LATERAL CHECKS

ğŸ”¸ Success â‰  end

Post-success logs:

**Windows**

* 4672 â†’ Privilege use
* 4688 â†’ Process creation
* 5145 â†’ File access
* 7045 â†’ Services

**Linux**

* sudo usage
* authorized_keys

**Cloud**

* Mailbox rules
* App consent
* Data downloads

---

### ğŸ§  PHASE 7 â€” CLASSIFICATION & DECISION

| Pattern                     | Verdict          |
| --------------------------- | ---------------- |
| Few failures, user confirms | Benign           |
| Service account repeats     | Misconfiguration |
| Invalid SSH users           | Internet noise   |
| Many users, one IP          | Password spray   |
| Failure â†’ success           | Incident         |

---

### ğŸ§  PHASE 8 â€” RESPONSE & DOCUMENTATION

#### ğŸ”§ Response actions

ğŸ”¹ Benign

* Close
* Tune rule

ğŸ”¹ Attack without success

* Block IP
* Enforce MFA
* Rate-limit

ğŸ”¹ Compromise

* Reset credentials
* Revoke sessions
* Full IR escalation

---

#### ğŸ“ What to document

ğŸ”¹ Detection logic
ğŸ”¹ Timeline
ğŸ”¹ Evidence
ğŸ”¹ Classification
ğŸ”¹ Actions
ğŸ”¹ Hardening steps

---

## ğŸ§  FINAL SOC TRUTH

ğŸ”‘ Multiple login failures are not an alert
ğŸ”‘ They are a story
ğŸ”‘ Investigation = reconstruction
ğŸ”‘ Master this â†’ master SOC incidents


